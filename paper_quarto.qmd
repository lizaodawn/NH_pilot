---
engine: knitr
title: "Keyword and Collocation analysis on India-related text of *Natural History*"
author: "Dawn, Lizao Zhuang (r0914937)"
format: 
  html:
    theme: journal
    toc: true
    code-link: true
    abstract-title: "Abstract"
number-sections: true
echo: false
warning: false
tbl-cap-location: top
bibliography:
  - references.bib
  - packages.bib  
csl: unified-style-sheet-for-linguistics.csl
abstract: 'This paper presents a comprehensive analysis of keywords and collocates related to India in a corpus of Natural History by Pliny the Elder. The study focuses on uncovering prominent themes and topics associated with India in the context of the book. The research employs keyword analysis and collocate examination techniques to reveal significant insights into the perception and imagination of India, as a competent counterpart to the Roman Empire, by Pliny the Elder and the scholars of his time.'
---

```{r setup, include=FALSE}
library('tidyverse')
library('mclm')
library('here')
library('kableExtra')
library('leaflet')
library('downlit')
options(digits = 3)

knitr::write_bib(
  c("base", "mclm", "ggplot2", "tidyverse", "leaflet", "downlit"),
  here("packages.bib")
)
```

# Research Question[^1]

[^1]: This study is a pilot study of my master thesis, so the description of the research question is connected with that of this [paper](https://raw.githack.com/lizaodawn/NH_thesis/main/NHthesis_structure.html#sec-introduction).

Pliny the Elder's *Natural History* is widely recognized as the earliest encyclopedia in the world. Written around AD 77, the work is thematically divided into 37 books, covering a diverse range of subjects including astronomy, geography, zoology, botany, medicine, and more. Driven by a pioneering attempt to catalogue human knowledge from his era, Pliny made a comprehensive reference to a wide range of Greek and Roman scholarships, and interwove his own literary interpretation or comments to the narratives in *Natural Hisrory*.

*Natural History* stands as a seminal work in the history of encyclopedias, serving as a gateway to understanding the knowledge and worldview of ancient Rome. Beyond its role as a compendium of diverse subjects, the text provides a captivating glimpse into the knowledge, cultural, and merchandise exchange [@dodd2021] between the Roman Empire and other regions while shedding a light on the spatial perception and imagination of Pliny and the scholarly references of his time [@plinyth2011].

As pointed out by @beagon2011, differentiating from his predecessors, Pliny showed a "terrestrial curiosity" in Natural History, emphasising recognition of the physical, material world. Drawing from the long-established topographical and ethnographic traditions, Pliny connects volumes dedicated to geography (books 3-6) with broader elements, activities, and cultural, historical, and societal contexts [@roller2022], exemplified in his portrayal of exotic plants, communities' habitats, imperial expeditions, and trade products. In this regard, geographical names mentioned in the text plays a pivotal role in distributing information, knowledge, and discussions throughout *Natural History*.

*Natural History* is originally in Latin. For this study, an English translation by Henry T. Riley (1816-1878) and John Bostock (1773-1846), first published in 1855, is utilized. The translated text is obtained in a digitised version from the [TOPOSText project](https://topostext.org/the-project), having been sourced from the Perseus Project and governed by a Creative Commons Attribution-Share-Alike 3.0 U.S. License.

In addition to the digitised textual content of *Natural History*, the place names mentioned in the text are annotated with their corresponding coordinates on TOPOXText. The annotations are available in an HTML format, which were sparsed and restructured into a dataset of geographical-related text in *Natural History* with [Beautiful Soup](https://www.crummy.com/software/BeautifulSoup/bs4/doc/) library in Python[^2]. The dataset structure, corpus scraping procedure and and corpus extention will be further elaborated in Corpus Description section (@sec-corpus).

[^2]: The sparsing [code](https://github.com/lizaodawn/zhuang/blob/papertry/Natural%20History_corpus.ipynb) is uploaded to the same repository of the project.

As a starting point, @fig-geoname reveals the Top 20 distinct geographical names mentioned within the text.

```{r}
#| label: fig-geoname
#| fig-cap: Bar chart for top 20 distinct place names mentioned in *Natural History*
#| fig-cap-location: top
#| warning: false
#| echo: false


data <- read.csv("geotext_whole.csv")

summary_data <- data %>%
  group_by(ToposText_ID, Place_Name, Lat, Long) %>%
  summarise(Count = n()) %>%
  arrange(desc(Count)) %>%
  ungroup() 


# Create a bar chart using ggplot2
top_20_summary_data <- summary_data %>%
  top_n(20, Count) %>%
  ungroup()

ggplot(top_20_summary_data, aes(x = reorder(Place_Name, -Count), y = Count)) +
  geom_col() +
  labs(x = "Place name", y = "Number of occurrences") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

An intriguing observation from this analysis, as depicted in @fig-map, is that India seems prominently mentioned in the work despite being outside the Mediterranean.

```{r}
#| label: fig-map
#| fig-cap: Mapping of geographical names mentioned in Natural History
#| fig-cap-location: top
#| warning: false
#| echo: false

m <- leaflet() %>%
  addTiles() %>%
  addCircleMarkers(
    data = summary_data,
    lat = ~Lat,
    lng = ~Long,
    radius = sqrt(summary_data$Count) * 0.8,  # Adjust the scaling factor as needed
    color = "blue",
    fill = TRUE,
    fillOpacity = 0.6,
    popup = paste("Place name:", summary_data$Place_Name, "<br>",
                  "Number of occurences:", summary_data$Count)
  )

m

```

Building upon this observation, the study focus is narrowed down to India-related text in *Natural History*, aiming to delve deeper into the themes associated with the Indian region referred in the text by employing keyword analysis and collocation analysis methods within the framework of corpus linguistics.

The analysis is conducted in R environment [@R-base], and the main anlysing methods are applied through functions from [mclm](https://masterclm.github.io/mclm/) [@R-mclm] package. In addition, [tidyverse](https://www.tidyverse.org/) [@R-tidyverse] and [leaflet](https://rstudio.github.io/leaflet/) [@R-leaflet] are used for data manipulation and visualisation.

# Methodology

To investigate the prominent themes in the India-related content discussed in *Natural History*, methods of keyword analysis and collocation analysis are employed for this study. Both of the analyses rely on the `mclm::assoc_scores` objects of the [mclm](https://github.com/masterclm/mclm) package, which return frequencies and association scores of a certain event in a target context and in a reference context.

Both of the methods will be examined by three association measurements, namely absolute frequency, PMI and $G^2$ signed, to discuss with the context in *Natural History* and the potential theme it indicates.

PMI measures the association strength between two words by comparing their observed co-occurrence frequency with their expected co-occurrence frequency by chance. It highlights words that appear together more frequently than expected. High PMI values indicates strong associations. High $G^2$ values suggest that the co-occurrence is unlikely to occur by chance.

$G^2$ is a statistical test that measures the independence or association between two categorical variables (words in this case). It compares the observed co-occurrence frequencies with the expected frequencies under the assumption of independence. Higher $G^2$ values suggest a stronger association.

## Keyword Analysis

Keyword analysis is a statistical method used in corpus linguistics to identify words that occur more frequently in a target corpus than in a reference corpus. Defined with different associate measurements, the "keyness" of words are calculated and indicated which words are statistically more frequent appeared in the target corpus comparing to that of the reference corpus.

In this study, the *target corpus* includes all paragraphs in *Natural History* mentioning Indian regions, and the **reference corpus** contains all other paragraphs in the work. Lists of 20 words with the highest score in different association measurements are discussed with the textual context. As indicated by the measurements, the listed words tend to be more frequently occur in the context pertaining India than other parts of the work, hence they seem to be the potential keywords about India in *Natural History*.

## Collocation Analysis

Collocation analysis is a technique employed in corpus linguistics to identify words that often appear together in a language. This technique is rooted in the notion that particular words tend to appear together more often than would occur by chance. In the context of this study, lists of the highly possible co-occuring word with "India" in the text of *Natural History* can shed a light on the potential themes and topics about India discussed in the work.

Combining the two methods, and integrating with a close reading of the text, this study aims to discuss what about "India" is discussed in *Natural History*.

# Corpus Description {#sec-corpus}

As mentioned, an English translation by Henry T. Riley (1816-1878) and John Bostock (1773-1846) of the original Latin text of *Natural History* is employed in the study.

The digitised text is avalible in paragraphs with geographical annotations on TOPOSText website as two parts, [book 1-11](https://topostext.org/work/148) and [book 12-37](https://topostext.org/work/153), both of which are in HTML format. Extracting all the "place" class in the HTML files, a dataset containing all annotated place names in the work, the URI and corresponding coordinates of the place, the book/chapter/paragraph number where it is mentioned, as well as the coordinating textual content are structured as a dataset of geographic-related text in *Natural History*. This dataset is used for an initial exploration of the prominent mentioned places in the text.

Since the research focus is narrowed down to India-related text after the initial exploration, a dataset including all Indian place names mentioned in the text is extracted from the geographical-related text dataset. With a reference to *Barrington Atlas of the Greek and Roman World* (@talbert2000, @talbert2000-1), the approximate coordinates defining the Indian region during the time of *Natural Hisoty* are as follows[^3]:

[^3]: As indicated in the map-by-map directory, the range spans territories of "modern states of India (minus the Punjab), Bangladesh, Bhutan, Burma, Nepal, and Sri Lanka".

> Latitude: 5-35 degrees North
>
> Longitude: 65-95 degrees East

The records in geographical-related text dataset with corresponding coordinates falling within the specified range are extracted as the India-related text dataset.

Each distinct paragraph in the India-related text dataset is extracted and stored in TXT format as separate files within a corpus folder, comprising a total of 146 files as the **target corpus** for India-related text in *Natural History*. The file names contain information about the book, chapter, and paragraph numbers.

And the full text of the entire work, segregating in paragraphs, are scraped and stored in TXT format and excluded the files in **target corpus** to serve as a **reference corpus**.

The text are set into lower case in the corpus file extraction process.

```{r}
#| label: prepare-corpus
#| warning: false

refcorpus_folder <- here("NH_wholetext")
fnames_wholetext <- get_fnames(refcorpus_folder) %>% 
  keep_re("[.]txt")


tarcorpus_folder <-  here("NH_geotext_india")
fnames_indiatext <- get_fnames(tarcorpus_folder) %>% 
  keep_re("[.]txt")

fnames_wholetext_short <- basename(fnames_wholetext)
fnames_indiatext_short <- basename(fnames_indiatext)

# Exclude short file names with the same name from target corpus in the reference corpus
fnames_wholetext_short_filtered <- fnames_wholetext_short %>%
  setdiff(fnames_indiatext_short)

# Filter full file names based on filtered short names
fnames_wholetext_filtered <- fnames_wholetext[fnames_wholetext_short %in% fnames_wholetext_short_filtered]

# build frequency list for reference corpus
flist_ref <- fnames_wholetext_filtered %>%
  freqlist(re_token_transf_in = "'", 
           token_transf_out = "")

# build frequency list for target corpus
flist_target <- fnames_indiatext %>%
  freqlist(re_token_transf_in = "'", 
           token_transf_out = "") 
```

The **target corpus** consists of all text related to India in paragraphs, containing `r prettyNum(n_tokens(flist_target))` tokens and `r n_types(flist_target)` types, with the type-token ratio of `r round(n_types(flist_target)/n_tokens(flist_target), 2)`.

And the **reference corpus** consists of all texts in *Natural History* in paragraphs, consisting of `r prettyNum(n_tokens(flist_ref))` tokens and `r n_types(flist_ref)` types, with the type-token ratio of `r round(n_types(flist_ref)/n_tokens(flist_ref), 2)`.

# Data Analysis

## Collocating word to "India" in *Natural History*

In addition to examining the keywords in the India-related texts, it is also valuable to explore the collocates that appear alongside the word "India" when mentioned in the book.

To analyse the textual collocating bi-gram of word "India", the `mclm::text_cooc()` function was employed, with "india" designated as the target item for the analysis. Since the texual collocation of "India" is examinated, the span of the target word is set as the "textual units", to take the broader context into consideration.

And following the same criteria as the previous keyword analysis, the collocation scores were filtered of having both PMI and G_signed scores of 2 or higher. By employing this approach, the prominent collocates of "india" were identified, providing a tangible understanding of the prevailing discourse and potentially reflecting Pliny the Elder's perspective on the region.

```{r}
#| label: collocation
#| warning: false

coocs <- fnames_wholetext %>% 
  text_cooc("(?xi)  ^ india $")

# calculate scores
scores_colloc <- assoc_scores(coocs)

top_scores_colloc <- scores_colloc %>% 
  filter(PMI >= 2 & G_signed >= 2)
```

@tbl-coltable_Gsigned and @tbl-coltable_PMI display the top 20 collocates associated with the word "india" in the entire text, respectively sorted by G_signed and PMI scores. As the returned $G^2$ score helps gauge the strength of evidence regarding the independence between the two words [@methods], thereby facilitating the initial sorting.

::: panel-tabset
### Sorted by absolute frequencies

```{r}
#| label: tbl-coltable_absolute_freqencies
#| tbl-cap-location: top
#| tbl-cap: Top 20 collocates to the word "india" in Natural History (sorted by G_signed)
#| warning: false
#| echo: false
top_scores_colloc %>% 
  as_tibble() %>%
  select(type, a, PMI, G_signed) %>% 
  slice_max(order_by = a, n = 20, with_ties = TRUE) %>%
  kbl(col.names = c("Type", "Frequency", "PMI", r"(Signed $G^2$)"), escape = FALSE) %>%
  kable_minimal() %>% 
  scroll_box(height = "400px")

```

### Sorted by G_singed

```{r}
#| label: tbl-coltable_Gsigned
#| tbl-cap-location: top
#| tbl-cap: Top 20 collocates to the word "india" in Natural History (sorted by G_signed)
#| warning: false
#| echo: false
top_scores_colloc %>% 
  as_tibble() %>%
  select(type, a, PMI, G_signed) %>% 
  slice_max(order_by = G_signed, n = 20, with_ties = TRUE) %>%
  kbl(col.names = c("Type", "Frequency", "PMI", r"(Signed $G^2$)"), escape = FALSE) %>%
  kable_minimal() %>% 
  scroll_box(height = "400px")

```

### Sorted by PMI

```{r}
#| label: tbl-coltable_PMI
#| tbl-cap-location: top
#| tbl-cap: Top 20 collocates to the word "india" in Natural History (sorted by PMI)

top_scores_colloc %>% 
  as_tibble() %>%
  select(type, a, PMI, G_signed) %>%
  slice_max(order_by = PMI, n = 20, with_ties = TRUE) %>% 
  kbl(col.names = c("Type", "Frequency", "PMI", r"(Signed $G^2$)"), escape = FALSE) %>% 
  kable_minimal() %>% 
  scroll_box(height = "400px") 

```
:::

Similar to the results of keyword analysis, the top 20 sorted list of absolute frequency and G singed have a 11/20 overlapped outputs. As shown in @fig-col_colloc, the signed G score and absolute frequency in textual collocation has a positibe correlation.

```{r}
#| label: fig-col_colloc
#| fig-cap: Correlation of signed G and absolute frequency in textual collocation


top_scores_colloc_df <- as_tibble(top_scores_colloc)

g1 <- top_scores_colloc_df %>%
  ggplot(aes(x = G_signed, y = a)) +
  labs(x = "signed G", y = "Absolute frequency") +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) 

g1
```

The high-ranking words of textual collocation with "India" in the work are cateforized as follows, those without specifying the association measurement are the overlapped ones:

**Geographical**: arabia, indian, ethiopia, ganges, indus(G)

**Numeric**: hundred, thousand(A), whole(A)

**Time**: year (A)

**Merchandise exchange**: mart(G)

**Precious Stone/Gem**: stones, rock-crystal, gems, pearls, gem(G), gemstone(G)

**Animal/Plant**: elephants, gum(A), lustre(G)

**Historical Figure**: alexander(A), megasthenes(G), onesicritus(G)

**Descriptive expression**: numerous(A), luxury(A), closely(A), valuable(A), bright(A), identical(G), smaragdus(G)

**Others**: shadow(A)

The top 20 collocates associated with the word "India," sorted by their $G^2$ scores, reveal three key dimensions:

1.  **Geographical Connections**: The collocates such as *arabia*, *ethiopia*, *east*, *south*, *opposite*, and *beyond* indicate the geographical relationships and proximity between India and these regions.

2.  **Trading and Imports**: The presence of collocates like *imported*, *produces*, *produce* and *nations* suggests that India had a significant role in trade and the importation of goods. It also implies that India was known for producing various commodities that were sought after by other nations.

3.  **Boundaries and Borders**: The collocates *boundary*, *set* and *part* indicate the existence of defined boundaries or borders related to India. This suggests that there were recognized territorial demarcations associated with India during the referenced period.

```{r}
coocs_ref_df <- as_tibble(coocs$ref_freqlist)
words_to_check_colloc <- c("arabia", "indian", "ethiopia", "ganges", "rock-crystal", "hundred", "elephants", "megasthenes", "indians", "gem", "lustre", "stones", "identical", "'smaragdus", "indus", "gems", "gemstone", "pearls", "onesicritus", "mart")
filtered_top_scores_colloc <- top_scores_colloc_df %>%
  filter(type %in% words_to_check_colloc)

abs_freq_lookup1 <- setNames(coocs_ref_df$abs_freq, coocs_ref_df$type)
nrm_freq_lookup1 <- setNames(coocs_ref_df$nrm_freq, coocs_ref_df$type)

results_colloc <- tibble(
  Word = filtered_top_scores_colloc$type,
  Target_Frequency = filtered_top_scores_colloc$a,
  Reference_Abs_Frequency = abs_freq_lookup1[filtered_top_scores_colloc$type],
  Reference_Nrm_Frequency = nrm_freq_lookup1[filtered_top_scores_colloc$type]
) %>% 
  kbl(col.names = c("Type", "Target_Frequency", "Reference_Abs_Frequency", "Reference_Nrm_Frequency")) %>% 
  kable_minimal() %>% 
  scroll_box(height = "400px")

results_colloc

```
```{r}

words_to_check_colloc_pmi <- c(
  "megasthenes",
  "thorn-bush",
  "carnelian",
  "obsidian",
  "cophes",
  "merchandize",
  "mart",
  "expeditions",
  "patala",
  "arii",
  "ichthyophagi",
  "pursuits",
  "vermilion",
  "biggest",
  "onesicritus",
  "identical",
  "ganges",
  "engrave",
  "'smaragdus",
  "honey-coloured",
  "reflects"
)

filtered_top_scores_colloc <- top_scores_colloc_df %>%
  filter(type %in% words_to_check_colloc_pmi)

abs_freq_lookup1 <- setNames(coocs_ref_df$abs_freq, coocs_ref_df$type)
nrm_freq_lookup1 <- setNames(coocs_ref_df$nrm_freq, coocs_ref_df$type)

results_colloc_pmi <- tibble(
  Word = filtered_top_scores_colloc$type,
  Target_Frequency = filtered_top_scores_colloc$a,
  Reference_Abs_Frequency = abs_freq_lookup1[filtered_top_scores_colloc$type],
  Reference_Nrm_Frequency = nrm_freq_lookup1[filtered_top_scores_colloc$type]
) %>% 
  kbl(col.names = c("Type", "Target_Frequency", "Reference_Abs_Frequency", "Reference_Nrm_Frequency")) %>% 
  kable_minimal() %>% 
  scroll_box(height = "400px")

results_colloc_pmi
```


Within the context of Pliny the Elder's *Natural History* is a book with an encyclopedia scope written in Roman Empire, these collocates suggest the interconnecting role India played in the network of interactions, trade, or cultural exchanges between India and the Mediterranean regions during 1st century AD. They highlight India's significance as a trading partner, its geographical positioning, and the recognition of its territorial boundaries.

## Keyword in India-related text in *Natural History*

As mentioned, the method of keyword analysis could help with a further discuss about the prominent theme and topic in the India-related texts.

The frequency lists for the **target corpus** (India-related texts) and **reference corpus** (whole text) are generated respectively, and the association scores are calculated through the `mclm::assoc_scores()` function. The association score is filtered based on the criteria of both PMI and $G^2$ scores, requiring a minimum score of 2. This criterion ensures that the selected words have a probability at least four times higher than the overall data, along with statistically significant supporting evidence [@methods], allowing to identify the most statistically significant keywords in India-related texts when compared to the reference corpus.

During the calculation of word frequencies in the **target corpus**, the specific word "India" itself was excluded from the analysis. This exclusion was intentional, aiming to focus on more descriptive words within the corpus and efficiently identify potential thematic keywords in the **target corpus**.

```{r}
#| label: keyword
#| warning: false

# calculate scores
scores_kw <- assoc_scores(flist_target, flist_ref)

top_scores_kw <- scores_kw %>% 
  filter(PMI >= 2 & G_signed >= 2)

```

The following tables present the top 20 keywords in India-related texts as compared to the entire texts in *Natural History*. They are sorted based on their PMI (@tbl-kwtable_PMI), Absolute frequencies(@tbl-kwtable_absolute_freqencies) and G_signed scores (@tbl-kwtable_Gsigned), respectively. The initial sorting was carried out based on the PMI scores (@tbl-kwtable_PMI), since the it serves as a crucial indicator for measuring the keyness of words.

::: panel-tabset
### Sorted by absolute frequencies

```{r}
#| warning: false
#| echo: false
#| label: tbl-kwtable_absolute_freqencies
#| tbl-cap-location: top
#| tbl-cap: Top 20 Keywords on Indian Related Text in Natural History (sorted by PMI)

top_scores_kw %>% 
  as_tibble() %>%
  select(type, a, PMI, G_signed) %>% 
  slice_max(order_by = a, n = 20, with_ties = TRUE) %>%                       
  kbl(col.names = c("Type", "Frequency", "PMI", r"(Signed $G^2$)")) %>% 
  kable_minimal() %>% 
  scroll_box(height = "400px")
```

### Sorted by PMI

```{r}
#| warning: false
#| echo: false
#| label: tbl-kwtable_PMI
#| tbl-cap-location: top
#| tbl-cap: Top 20 Keywords on Indian Related Text in Natural History (sorted by PMI)

top_scores_kw %>% 
  as_tibble() %>%
  select(type, a, PMI, G_signed) %>% 
  slice_max(order_by = PMI, n = 20, with_ties = TRUE) %>%                       
  kbl(col.names = c("Type", "Frequency", "PMI", r"(Signed $G^2$)")) %>% 
  kable_minimal() %>% 
  scroll_box(height = "400px")
```

### Sorted by G_signed

```{r}
#| warning: false
#| echo: false
#| label: tbl-kwtable_Gsigned
#| tbl-cap-location: top
#| tbl-cap: Top 20 Keywords on Indian Related Text in Natural History (sorted by G_Signed)

top_scores_kw %>% # also valid for top_scores_colloc
  as_tibble() %>%
  select(type, a, PMI, G_signed) %>%         # sort by PMI (descending) 
  slice_max(order_by = G_signed, n = 20, with_ties = TRUE) %>%   
  kbl(col.names = c("Type", "Frequency", "PMI", r"(Signed $G^2$)")) %>% 
  kable_minimal() %>% 
  scroll_box(height = "400px")
```
:::

In the list of three measurements, 16/20 of absolute frequency overlaps with that of $G^2$ Signed. As shown in the @fig-col_keyword, the $G^2$ score has a positive correlation with the absolute frequency.

```{r}
#| label: fig-col_keyword
#| fig-cap: Scatterplot of G_signed by absolute frequency

top_scores_kw_df <- as_tibble(top_scores_kw)

theme_set(theme_minimal(base_size = 15))
g <- top_scores_kw_df %>%
  ggplot(aes(x = G_signed, y = a)) +
  labs(x = "Signed G", y = "Absolute frequency")
g + geom_point()
```

Combing the lists sorted by absolute frequency and signed G, it can be categorized as follows (those without specified are the overlapped words):

**Geographical**: india, arabia, indian, ganges, indus, ethiopia, taprobane(G), thence, sail(A)

**People**: alexander, indians, tribe(A), ichthyophagi(G), megasthenes(G)

**Numeric**: hundred, thousand, fifty(A)

**Precious Stone/Gem**: stones, amber, rock-crystal, glass, beryls(G)

**Animal/Plant**: elephants, pepper(A)

The categories partly highlights the potential themes in the target corpus, i.e. India-related text in *Natural History*, that a lot of geographical details, including land marks, locations and spatial transportation, as well as precious stones and introduction about tribes, historical figures and animal and plants.

It aligns with the general structure of the work, that catelouging the natural, material world in to chapters of geography, anthropology, natural creatures and mineralogy.

And the high ranking words even have more appearences in the reference corpus, as shown in @tbl-kw_frequency_compare.

```{r}
#| label: tbl-kw_frequency_compare
#| tbl-cap:  Comparison of overlapping keywords sorted by absolute frequency and G signed with that of reference corpus
flist_ref_df <- as_tibble(flist_ref)
words_to_check <- c("india", "hundred", "stones", "arabia", "indian", "alexander",
                    "amber", "thousand", "elephants", "indus", "glass", "thence",
                    "ganges", "rock-crystal", "ethiopia", "indians")


filtered_top_scores <- top_scores_kw_df %>%
  filter(type %in% words_to_check)

abs_freq_lookup <- setNames(flist_ref_df$abs_freq, flist_ref_df$type)
nrm_freq_lookup <- setNames(flist_ref_df$nrm_freq, flist_ref_df$type)

results <- tibble(
  Word = filtered_top_scores$type,
  Target_Frequency = filtered_top_scores$a,
  Reference_Abs_Frequency = abs_freq_lookup[filtered_top_scores$type],
  Reference_Nrm_Frequency = nrm_freq_lookup[filtered_top_scores$type]
) %>% 
  kbl(col.names = c("Type", "Target_Frequency", "Reference_Abs_Frequency", "Reference_Nrm_Frequency")) %>% 
  kable_minimal() %>% 
  scroll_box(height = "400px")


results

```

As PMI score indicates times of probability of the keyword in the target context higher than its probability in all the data taken together, it could serve as a more convincing indicator for the analysis of keywords. And in fact, in the sorted top 20 list of PMI, it does showed more detailed information about the context. Moreover, almost all of them shown none frequency in the reference corpus, which reinforces the indication that they are distinctly key to the target corpus comparing to that of the other context of the work, as shown in @tbl-kw_frequency_pmi.

```{r}
#| label: tbl-kw_frequency_pmi
#| tbl-cap:  Comparison of overlapping keywords sorted by absolute frequency and G signed with that of reference corpus

words_to_check_pmi <- c("india", "ganges", "beryls", "indus", "taprobane",
                    "ichthyophagi", "megasthenes", "obsidian", "bdellium",
                    "agates", "callaina", "condensation", "expeditions",
                    "gerra", "jomanes", "nonius", "patala", "prasii", "alia",
                    "bactra", "carnelian", "ceylon", "cophes", "hypasis",
                    "merchandize", "pepper-tree", "sacae", "sandastros",
                    "thorn-bush")

filtered_top_scores1 <- top_scores_kw_df %>%
  filter(type %in% words_to_check_pmi)

abs_freq_lookup1 <- setNames(flist_ref_df$abs_freq, flist_ref_df$type)
nrm_freq_lookup1 <- setNames(flist_ref_df$nrm_freq, flist_ref_df$type)

results1 <- tibble(
  Word = filtered_top_scores1$type,
  Target_Frequency = filtered_top_scores1$a,
  Reference_Abs_Frequency = abs_freq_lookup1[filtered_top_scores1$type],
  Reference_Nrm_Frequency = nrm_freq_lookup1[filtered_top_scores1$type]
)%>% 
  kbl(col.names = c("Type", "Target_Frequency", "Reference_Abs_Frequency", "Reference_Nrm_Frequency")) %>% 
  kable_minimal() %>% 
  scroll_box(height = "400px")


results1


```

From these keywords, a manual examination was performed to determine their meaning and assign appropriate tags as based on their category. The resulting explanations for the top 20 keywords, sorted by PMI, can be found in @tbl-kwlist below.

```{r}
#| warning: false
#| echo: false
#| label: tbl-kwlist
#| tbl-cap: Top 20 keywords with meaning sorted by PMI
#| tbl-cap-location: top

keyword_PMI_list <- data.frame(
  Word = c("india", "ganges", "beryls", "indus", "taprobane", "ichthyophagi", "megasthenes", "obsidian", "bdellium", "agates", "callaina", "condensation", "expeditions", "gerra", "jomanes", "nonius", "patala", "prasii", "alia", "bactra", "carnelian", "ceylon", "cophes", "hypasis", "merchandize", "peppertree", "sacae", "sandastros", "thornbush"),
  Exp = c("name of the focused region of this study", "a major river in India", "a type of gemstone", "a major river in India", "Island in Sri Lanka", "a group of people who primarily subsist on fish", "a Greek historian and diplomat", "a type of volcanic glass", "a fragrant resin obtained from certain trees", "a type of semiprecious gemstone", "pale green precious stone (lat)", "the process of vapor turning into a liquid state", "referring to the expedition of Alexander the Great", "war (lat)", "name of a river", "a Roman nomen gentile, gens or \"family name\"", "refer to a city in Indian region", "prase, green coloured gem", "by another / different way / route (lat)", "name of a city in Asia Minor", "a reddish-brown variety of chalcedony", "name of an Island in Indian subcontinent", "a river that rises in the ancient Paropamise range, eventually falling into the Indus river near its confluence with the Cophes river", "a river in north India", "goods or commodities", "a tree that produces peppercorns", "the easternmost nation of Elibe, situated to the south of Ilia and the north of Bern", "a precious stone found in India and Arabia", "any of many thorny or spiny shrubs and bushes"),
  Category = c("region", "river", "goods", "river", "region", "people", "people", "goods", "goods", "goods", "goods", "activity", "activity", "activity", "river", "people", "region", "goods", "route", "region", "goods", "region", "river", "river", "goods", "plant", "river", "goods", "plant"),
  Remark = c("N/A", "N/A", "gemstone", "N/A", "N/A", "tribe", "referencing scholar", "other goods", "other goods", "gemstone", "gemstone", "producing activity", "N/A", "N/A", "N/A", "human name", "N/A", "gemstone", "N/A", "N/A", "gemstone", "N/A", "N/A", "N/A", "general goods", "origin of goods", "N/A", "gemstone", "N/A")
)

keyword_PMI_list %>% 
  as_tibble() %>%
  select(Word, Exp, Category, Remark) %>%                        
  kbl(col.names = c("Word", "Exp", "Category", "Remark")) %>% 
  kable_minimal()
```

The distribution plot of categories, as demonstrated in @fig-kwtype, reveals the pattern regarding keywords of India-related texts in *Natural History*.

```{r}
#| warning: false
#| echo: false
#| label: fig-kwtype
#| fig-cap: Top 20 keywords type distribution
#| fig-cap-location: top

tag_counts <- keyword_PMI_list %>%
  count(Category) %>%
  arrange(desc(n))

# Plot the tag distribution
ggplot(tag_counts, aes(x = n, y = reorder(Category, -n), fill = Category)) +
  geom_bar(stat = "identity") +
  labs(x = "Count", y = "Category", fill = "Category") +
  theme_minimal() +
  coord_flip()
```

Significantly, a substantial number of the keywords in the India-related text revolve around goods, particularly precious stones, suggesting a prominent thematic focus. The presence of keywords such as *beryls*, *obsidian*, *bdellium*, *agates*, *callaina*, *prasii*, *carnelian* and *sandastros* indicates the involvement of various gemstones and goods associated with India. These findings are complemented by the presence of keywords like *condensation*, *merchandize* and *peppertree* which suggest the production and trade of goods between the Roman Empire and the Indian regions during that era.

Furthermore, the keywords related to rivers in India, such as *ganges*, *cophes*, *hypasis*, and *sacae* indicate their significance as sources of goods or as integral parts of trading routes. Since Pliny the Elder's contextual framework includes critical descriptions of the geographical surroundings like rivers, as evident in his references to the Po River and the Nile River [@pollard2009; @murphy2003], a deeper investigation into the portrayal and role of Indian rivers within this context would provide valuable insights.

Additionally, a notable proportion of the keywords pertain to people, encompassing names, descriptions, and specific historical figures like *megasthenes*. This suggests the historical significance of individuals who played a role in trade with India or in documenting and understanding the region.

In conclusion, the keywords extracted from the India-related text in the *Natural History* shed light on India's role in trade, the production of valuable goods, and its association with notable historical figures and geographical features within the perspective of Pliny the Elder during the 1st century AD in the context of the Roman Empire. These findings could also contribute to a better understanding of India's historical interactions with the broader ancient world.


# Conclusion

In conclusion, this paper located the research question on potential theme and topics in texts about India in Pliny the Elder's *Natural History* based on the prominent distribution of "India" in the entire text comparing to other place names. The analysis was conducted with the keyword analysis and collocation analysis in a framework of corpus linguistics.

The analysis of keywords in the India-related text revealed significant themes such as the rivers, gemstones, goods, and historical figures like Megasthenes. These findings emphasize the cultural, geographical, and historical importance of India in the scope of scholars in Roman Empire during 1st century AD.

Moreover, the exploration of collocates uncovered the geographical connections, trading networks, and territorial boundaries linked to India. The collocates highlighted the close relationships with neighboring regions such as Arabia and Ethiopia, along with references to trade, imports, and commodity production.

Additionally, the study provided information on the specific contexts and usage of the word "India" within Pliny the Elder's *Natural History*, as a resource for further analysis about the discourse and recognition of India during that era.

While this research represents an initial exploration, it paves the way for future investigations. Subsequent studies can expand the analysis to encompass a wider range of texts, explore different domains within Indian subcontinent-related literature, and utilize advanced natural language processing techniques to gain deeper semantic insights.
