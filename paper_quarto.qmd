---
engine: knitr
title: "Collocation and keyword analysis on India-related text of *Natural History*"
author: "Dawn, Lizao Zhuang (r0914937)"
format: 
  html:
    theme: journal
    toc: true
    code-link: true
    abstract-title: "Abstract"
number-sections: true
echo: false
warning: false
tbl-cap-location: top
fig-cap-location: top
bibliography:
  - references.bib
  - packages.bib  
csl: unified-style-sheet-for-linguistics.csl
abstract: 'This paper presents a comprehensive analysis of keywords and collocates related to India in a corpus of Natural History by Pliny the Elder. The study focuses on uncovering prominent themes and topics associated with India in the context of the book. The research employs collocate examination techniques and keyword analysis to reveal significant insights into the perception and imagination of India, as a competent counterpart to the Roman Empire, by Pliny the Elder and the scholars of his time.'
---

```{r setup, include=FALSE}
library('tidyverse')
library('mclm')
library('here')
library('kableExtra')
library('leaflet')
library('downlit')
options(digits = 3)

knitr::write_bib(
  c("base", "mclm", "tidyverse", "leaflet", "kableExtra", "downlit"),
  here("packages.bib")
)
```

# Research Question[^1]

[^1]: The present paper is a pilot study of my master thesis, *Mapping India in Pliny the Elder's Natural History*, thus the description of the research question is connected with the content in this [thesis](https://raw.githack.com/lizaodawn/NH_thesis/main/NHthesis_structure.html#sec-introduction).

Pliny the Elder's *Natural History* is widely recognized as the earliest encyclopedia in the world. Written around AD 77, the work is thematically divided into 37 books, covering a diverse range of subjects including astronomy, geography, zoology, botany, medicine, and more. Driven by a pioneering attempt to catalog human knowledge from his era, Pliny made a comprehensive reference to a wide range of Greek and Roman scholarships, and interwove his own literary interpretation or comments to the narratives in *Natural History*.

*Natural History* stands as a seminal work in the history of encyclopedias, serving as a gateway to understanding the knowledge and worldview of ancient Rome. Beyond its role as a compendium of diverse subjects, the text provides a captivating glimpse into the knowledge, cultural, and merchandize exchange [@dodd2021] between the Roman Empire and other regions [@plinyth2011].

As pointed out by @beagon2011, differentiating from his predecessors, Pliny showed a "terrestrial curiosity" in *Natural History*, emphasizing recognition of the physical, material world. Drawing from the long-established topographical and ethnographic traditions, Pliny connects volumes dedicated to geography (books 3-6) with broader natural elements, human activities, and cultural, historical, and societal contexts [@roller2022], exemplified in his description of plants, tribe habitats, imperial expeditions, and trade products. In this regard, this study aims to analyse the text of *Natural History* in a spatial scope, as geographical names mentioned in the text plays a pivotal role in distributing information, knowledge, and discussions throughout the work.

*Natural History* is originally in Latin. An English translation by Henry T. Riley (1816-1878) and John Bostock (1773-1846), first published in 1855, is utilized for this study. The translated text is obtained in a digitized version from the [TOPOSText project](https://topostext.org/the-project), having been sourced from the Perseus Project and governed by a Creative Commons Attribution-Share-Alike 3.0 U.S. License.

In addition to the digitized textual content of *Natural History*, the place names mentioned in the text are annotated with their corresponding coordinates on TOPOXText. Since the annotations are available in an HTML format, they are scraped and restructured into a dataset of geographical-related text in *Natural History* with [Beautiful Soup](https://www.crummy.com/software/BeautifulSoup/bs4/doc/) library in Python[^2]. The dataset structure, corpus scraping procedure and and corpus extension will be further explained in Corpus Description section (@sec-corpus).

[^2]: The scraping [code](https://github.com/lizaodawn/zhuang/blob/papertry/Natural%20History_corpus.ipynb) is uploaded to the same repository of the project.

As a starting point of this study, @fig-top20geoname reveals the 20 most frequently mentioned geographical names within the text.

```{r}
#| label: fig-top20geoname
#| fig-cap: Top 20 most frequently mentioned place names in *Natural History*


data <- read.csv("geotext_whole.csv")

summary_data <- data %>%
  group_by(ToposText_ID, Place_Name, Lat, Long) %>%
  summarise(Count = n()) %>%
  arrange(desc(Count)) %>%
  ungroup() 


top_20_summary_data <- summary_data %>%
  top_n(20, Count) %>%
  ungroup()

ggplot(top_20_summary_data, aes(x = reorder(Place_Name, -Count), y = Count)) +
  geom_col() +
  labs(x = "Place name", y = "Number of occurrences") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Additionally, @fig-geonamemap depicted the times of each place name found mentioned in the work on a map. The individual places are represented by distinct dots, and its occurring times in the text are represented by the size of the dots. The larger the dot size, the more frequent it is appeared in the context.

```{r}
#| label: fig-geonamemap
#| fig-cap: Mapping of geographical names mentioned in *Natural History*
#| fig-cap-location: top
#| warning: false
#| echo: false

m <- leaflet() %>%
  addTiles() %>%
  addCircleMarkers(
    data = summary_data,
    lat = ~Lat,
    lng = ~Long,
    radius = sqrt(summary_data$Count) * 0.8,  # Adjust the scaling factor as needed
    color = "blue",
    fill = TRUE,
    fillOpacity = 0.6,
    popup = paste("Place name:", summary_data$Place_Name, "<br>",
                  "Number of occurences:", summary_data$Count)
  )

m

```

An intriguing observation from these figures is that India seems being prominently mentioned in the work despite locating outside the Mediterranean.

Building upon this observation, the study focus is narrowed down to India-related text in *Natural History*. By delving deeper into the themes associated with the Indian region referred in the text, this study aims to examine the portrayal of India by Pliny the Elder, which potentially shed a light on the spatial perception and imagination of the representative writers and scholars of ancient Rome.

# Methodology {#sec-method}

To investigate the prominent themes in the India-related content discussed in *Natural History*, the study generally employs methods of collocation analysis and keyword analysis in corpus linguistics, and is conducted in R environment [@R-base]. The discussions are based on the `mclm::assoc_scores` objects returned from [mclm](https://masterclm.github.io/mclm/) [@R-mclm] package. In addition, [tidyverse](https://www.tidyverse.org/) [@R-tidyverse] and [leaflet](https://rstudio.github.io/leaflet/) [@R-leaflet] packages are used for data manipulation and visualization.

In the Data Analysis section (@sec-data_analysis), both of the collocation and keyword analysis are examined by three association measures, namely absolute frequency, PMI and signed $G^2$ for discussing the potential theme it inferred integrating with a close reading of the context.

Absolute frequency refers to the simple count of each single type (distinct word) observed in the text. In the case of collocation analysis, it shows the time a type collocates with the target word. While in the case of keyword analysis, it shows the time a type occurs in the target corpus. As a basic counting measure, absolute frequency provide an overview of the word distribution with limited insights.

PMI (Pointwise Mutual Information) is one of effect size measures for association. It compares the observed co-occurring frequency of two outcomes to the probability of either of them occurring independently. It can be applied to observe word association, and the association between words and context categories as well [@bestvater2022]. As the PMI value increases by one, the probability becomes twice as high. High PMI values indicates strong associations.

$G^2$ refers to the log-likelihood ratio for measuring the strength of statistical evidence of the observasion [@blume2017]. In the context of this study, it indicates how significant the association between the two factors (either for two words or for keywords associating with a target corpus) is. Specificly, the signed $G^2$ score returned by `mclm::assoc_scores` shows the strength of evidence for attraction, i.e. co-occurrence. High signed $G^2$ values suggest that the co-occurrence is unlikely to occur by chance.

Since a PMI score higher than two indicates a four times higher probability of association, and a signed $G^2$ score higher than 3.84 indicates a significant association at a 95% confidence level [@montes2022], a filter of "PMI \>= 2 & signed $G^2$ \>= 3.84" is applied for the returned objects of `mclm::assoc_scores` for both of the methods, in order to gain strong and significant association outputs for further discussion.

## Collocation Analysis

Collocation analysis is a technique employed in corpus linguistics to identify words that often appear together in a given text. This technique is rooted in the notion that particular words tend to appear together more often than they would occur by chance.

In this study, the textual collocating word with "India" in *Natural History* is examined. Lists of highly frequent co-occurring word with "India" in the context are obtained and sorted by scores of different measurements. The potential theme of India-related content in the work can be discussed based on the output of textual collocation of word "India".

## Keyword Analysis

Keyword analysis is a statistical method used in corpus linguistics to identify words that occur more frequently in a target corpus than in a reference corpus. The words showing higher association with the target corpus comparing to its frequency in the reference corpus are seen as the "keyword" of the target corpus.

In this study, the **target corpus** includes all paragraphs in *Natural History* mentioning place names in Indian regions, and the **reference corpus** contains all other paragraphs in the work. Lists of words with relatively higher frequency in the target corpus are obtained and sorted by scores of different measurements. The "keywords" found in India-related text in *Natural History* provides more descriptive information about the topics and elements related to "India" in Pliny's narrative.

Combining the two methods, and integrating with a close reading of the text, this study aims to gain insights about how "India" is discussed and portrayed in *Natural History*.

# Corpus Description {#sec-corpus}

As mentioned, an English translation by Henry T. Riley (1816-1878) and John Bostock (1773-1846) of the original Latin text of *Natural History* is employed in the study.

The digitized text is available in paragraphs with geographical annotations on TOPOSText website as two parts, [book 1-11](https://topostext.org/work/148) and [book 12-37](https://topostext.org/work/153), both of which are in HTML format. Extracting all "place" class in the HTML files, information of all annotated place names in the work, the URI and corresponding coordinates of the place, the book/chapter/paragraph number where it is mentioned, as well as the coordinating textual content is structured as a dataset of geographical-related text in *Natural History*. This dataset is used for an initial exploration of the prominent mentioned places in the text.

The initial obeservation shown in @fig-top20geoname and @fig-geonamemap leads to a focus to the India-related text for this study. With a reference to *Barrington Atlas of the Greek and Roman World* [@talbert2000; @talbert2000-1], the approximate geographical coordinates defining the Indian region during the time of *Natural Hisoty* are as follows[^3]:

[^3]: As indicated in the map-by-map directory, the range spans territories of "modern states of India (minus the Punjab), Bangladesh, Bhutan, Burma, Nepal, and Sri Lanka".

> Latitude: 5-35 degrees North
>
> Longitude: 65-95 degrees East

The records in geographical-related text dataset with corresponding coordinates falling within the specified range are extracted as the India-related text dataset.

```{r}
#| label: prepare-corpus
#| warning: false

refcorpus_folder <- here("NH_wholetext")
fnames_wholetext <- get_fnames(refcorpus_folder) %>% 
  keep_re("[.]txt")


tarcorpus_folder <-  here("NH_geotext_india")
fnames_indiatext <- get_fnames(tarcorpus_folder) %>% 
  keep_re("[.]txt")

fnames_wholetext_short <- basename(fnames_wholetext)
fnames_indiatext_short <- basename(fnames_indiatext)

# Exclude short file names with the same name from target corpus in the reference corpus
fnames_wholetext_short_filtered <- fnames_wholetext_short %>%
  setdiff(fnames_indiatext_short)

# Filter full file names based on filtered short names
fnames_wholetext_filtered <- fnames_wholetext[fnames_wholetext_short %in% fnames_wholetext_short_filtered]

# build frequency list for reference corpus
flist_ref <- fnames_wholetext_filtered %>%
  freqlist(re_token_transf_in = "'", 
           token_transf_out = "")

# build frequency list for target corpus
flist_target <- fnames_indiatext %>%
  freqlist(re_token_transf_in = "'", 
           token_transf_out = "") 
```

Each distinct paragraph in the India-related text dataset is extracted and stored in TXT format as separate files within a corpus folder, comprising a total of `r length(fnames_indiatext)` files as the **target corpus**. The file names contain information about the book, chapter, and paragraph number of the text.

And the full text of the entire work, separated in paragraphs, are also scraped and stored in TXT format. Excluding those in **target corpus**, the other part of the work, containing `r length(fnames_wholetext_filtered)` files, serve as a **reference corpus**.

The text are set into lower case in the corpus file extraction process.

The **target corpus** consists of all text related to India in paragraphs, containing `r prettyNum(n_tokens(flist_target))` tokens and `r n_types(flist_target)` types, with the type-token ratio of `r round(n_types(flist_target)/n_tokens(flist_target), 2)`.

And the **reference corpus** consists of all texts in *Natural History* in paragraphs, consisting of `r prettyNum(n_tokens(flist_ref))` tokens and `r n_types(flist_ref)` types, with the type-token ratio of `r round(n_types(flist_ref)/n_tokens(flist_ref), 2)`.

# Data Analysis {#sec-data_analysis}

## Textual collocating word with "India" in *Natural History*

Textual collocation refers to the observation of some words frequently occurring with the target word in the context. Different from the surface collocation, which taking the collocating span, i.e. the certain words left and right to the target word into consideration [@evert2009], the word span in this case refers to the textual unit around the target word. Setting "India" as the target word in the corpus of all paragraphs in *Natural History*, the `mclm::text_cooc()` function returns the frequency of words appeared in the context of "India". As mentioned in the Methodology Section (@sec-method), the returned scores are filtered with a statistical criteria for gaining a list of the most frequently observed words in the context of word "India" with strong significance. 

The prominent textual collocates of "India" identified with this approach suggests the potential themes about Indian region in the narrative of Pliny.

```{r}
#| label: collocation
#| warning: false

coocs <- fnames_wholetext %>% 
  text_cooc("(?xi)  ^ india $")

# calculate scores
scores_colloc <- assoc_scores(coocs)

top_scores_colloc <- scores_colloc %>% 
  filter(PMI >= 2 & G_signed >= 3.84)
```

@tbl-coltable_absolute_freqencies, @tbl-coltable_Gsigned and @tbl-coltable_PMI display the top 20 contextual collocates associated with the word "india", respectively sorted by absolute frequency, signed $G^2$ scores and PMI scores. 

::: panel-tabset

### Sorted by absolute frequencies

```{r}
#| label: tbl-coltable_absolute_freqencies
#| tbl-cap-location: top
#| tbl-cap: Top 20 collocates to the word "india" in Natural History (sorted by absolute freqencies)
#| warning: false
#| echo: false
top_scores_colloc %>% 
  as_tibble() %>%
  select(type, a, PMI, G_signed) %>% 
  slice_max(order_by = a, n = 20, with_ties = TRUE) %>%
  kbl(col.names = c("Type", "Frequency", "PMI", r"(Signed $G^2$)"), escape = FALSE) %>%
  kable_minimal() %>% 
  scroll_box(height = "400px")

```

### Sorted by Signed $G^2$

```{r}
#| label: tbl-coltable_Gsigned
#| tbl-cap-location: top
#| tbl-cap: Top 20 collocates to the word "india" in Natural History (sorted by signed $G^2$)
#| warning: false
#| echo: false
top_scores_colloc %>% 
  as_tibble() %>%
  select(type, a, PMI, G_signed) %>% 
  slice_max(order_by = G_signed, n = 20, with_ties = TRUE) %>%
  kbl(col.names = c("Type", "Frequency", "PMI", r"(Signed $G^2$)"), escape = FALSE) %>%
  kable_minimal() %>% 
  scroll_box(height = "400px")

```

### Sorted by PMI

```{r}
#| label: tbl-coltable_PMI
#| tbl-cap-location: top
#| tbl-cap: Top 20 collocates to the word "india" in Natural History (sorted by PMI)

top_scores_colloc %>% 
  as_tibble() %>%
  select(type, a, PMI, G_signed) %>%
  slice_max(order_by = PMI, n = 20, with_ties = TRUE) %>% 
  kbl(col.names = c("Type", "Frequency", "PMI", r"(Signed $G^2$)"), escape = FALSE) %>% 
  kable_minimal() %>% 
  scroll_box(height = "400px") 

```

:::

The top 20 ranking lists of absolute frequency and signed $G^2$ scores have a 11/20 overlapped outputs. As shown in @fig-col_colloc, the signed $G^2$ score and absolute frequency in textual collocation analysis shows a positive correlation.

```{r}
#| label: fig-col_colloc
#| fig-cap: Scatter plot of signed $G^2$ scores by absolute frequency in textual collocation analysis


top_scores_colloc_df <- as_tibble(top_scores_colloc)

theme_set(theme_minimal(base_size = 15))
g1 <- top_scores_colloc_df %>%
  ggplot(aes(x = G_signed, y = a)) +
  labs(x = "signed $G^2$", y = "Absolute frequency") +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) 

g1
```

The high-ranking words in textual collocation with "India" sorted by absolute frequency and signed $G^2$ scores are categorized as follows, those without specifying the association measures ("A" stands for "absolute frequency" and "G" stands for "signed $G^2$ scores") are the overlapped ones. These words listed out comprises the strongest evidence of collocating with "India" in the context.

**Geographical connections**: *arabia*, *indian*, *ethiopia*, *ganges*, *indus*(G)

**Animal/Plant**: *elephants*, *gum*(A), *lustre*(G)

**Precious stone**: *stones*, *rock-crystal*, *gems*, *gem*(G), *gemstone*(G), *pearls*

**Historical figure**: *alexander*(A), *megasthenes*(G), *onesicritus*(G)

**Merchandize exchange**: *mart*(G)

**Descriptive expression**: *hundred*, *thousand*(A), *whole*(A), *numerous*(A), *luxury*(A), *closely*(A), *valuable*(A), *bright*(A), *identical*(G), *smaragdus*(G)

**Others**: *shadow*(A), *year*(A)

These categories indicates that the narrative about "India" in *Natural History* covers three major dimensions. The first dimension is its geographical situation, including its connection to other places (mainly Arabia and Ethiopia), the two major rivers, Ganges and Indus within the region, and the animals, plants and precious stones originated in it. And it is often mentioned with historical figures, some related to the conquest history of the Roman Empire (in the case of *alexander*, referring to Alexander the Great, who had conducted several expeditions to Indian subcontinent), and some related to the referencing scholarship Pliny made his dialogue with. Moreover, the collocating word *mart* and the descriptive expressions highlights the merchandize exchanges introduced and discussed in the India-related content in the work.

In the `mclm::text_cooc()` function, the given text will be separated as target context (text surrounding the target node) and reference context (text not surrounding the target node). The normalized frequency of the top ranking words with the highest frequency and strongest evidence in the target context are at least 20 times higher than that of the reference context, as shown in @tbl-colloc_freq_compare_AFG.  

```{r}
#| label: tbl-colloc_freq_compare_AFG
#| tbl-cap:  Frequency comparison of overlapping textual collocating words sorted by absolute frequency and signed $G^2$ score in the top 20 ranking in target and reference context

coocs_ref_df <- as_tibble(coocs$ref_freqlist)
coocs_tar_df <- as_tibble(coocs$target_freqlist)

words_to_check_colloc <- c("arabia", "indian", "ethiopia", "ganges", "rock-crystal", "hundred", "elephants", "megasthenes", "indians", "gem", "lustre", "stones", "identical", "'smaragdus", "indus", "gems", "gemstone", "pearls", "onesicritus", "mart")

filtered_top_scores_colloc <- coocs_tar_df %>%
  filter(type %in% words_to_check_colloc)

tar_nrm_freq_lookup1 <- setNames(coocs_tar_df$nrm_freq, coocs_tar_df$type)
nrm_freq_lookup1 <- setNames(coocs_ref_df$nrm_freq, coocs_ref_df$type)

results_colloc <- tibble(
  Word = filtered_top_scores_colloc$type,
  Target_Nrm_Frequency = tar_nrm_freq_lookup1[filtered_top_scores_colloc$type],
  Reference_Nrm_Frequency = nrm_freq_lookup1[filtered_top_scores_colloc$type]
) %>% 
  arrange(desc(Target_Nrm_Frequency)) %>% 
  kbl(col.names = c("Type", "Target_Nrm_Frequency", "Reference_Nrm_Frequency")) %>% 
  kable_minimal() %>% 
  scroll_box(height = "400px")


results_colloc

```

When checking about the normalized frequency of the top 20 list sorted with PMI scores, as shown in @tbl-colloc_frequency_compare_PMI, all of the results show higher frequency than that in the reference context as well.
```{r}
#| label: tbl-colloc_frequency_compare_PMI
#| tbl-cap:  Frequency comparison of top 20 textual collocating words sorted by PMI score in target and reference context

words_to_check_colloc_pmi <- c("megasthenes", "thorn-bush", "carnelian", "obsidian", "cophes", "merchandize", "mart", "expeditions", "patala",   "arii", "ichthyophagi", "pursuits", "vermilion", "biggest", "onesicritus", "identical", "ganges", "engrave", "'smaragdus", "honey-coloured",   "reflects"
)

filtered_top_scores_colloc_pmi <- coocs_tar_df %>%
  filter(type %in% words_to_check_colloc_pmi)


results_colloc_pmi <- tibble(
  Word = filtered_top_scores_colloc_pmi$type,
  Target_Nrm_Frequency = tar_nrm_freq_lookup1[filtered_top_scores_colloc_pmi$type],
  Reference_Nrm_Frequency = nrm_freq_lookup1[filtered_top_scores_colloc_pmi$type]
) %>% 
  arrange(desc(Target_Nrm_Frequency)) %>%
  kbl(col.names = c("Type", "Target_Nrm_Frequency", "Reference_Nrm_Frequency")) %>% 
  kable_minimal() %>% 
  scroll_box(height = "400px")

results_colloc_pmi

```

The PMI word list, indicating the words with relatively strongest attraction to the word "India" in the context, shows more descriptive information about the theme related to India in *Natural History*. Most of them can be classified to the categories set for the overlapping high ranking absolute frequency and signed $G^2$ scores, and some words contribute to a new category relating to the exsisting categories, as shown in the classification as follows:

**Geographical connections**: *cophes*, *patala*, *ganges*

**Animal/Plant**: *thorn-bush*

**Precious stone**: *carnelian*, *obsidian*, *'smaragdus*

**Historical figure**: *megasthenes*, *onesicritus*

**Merchandize exchange**: *merchandize*, *mart*

**Descriptive expression**: *vermilion*, *biggest*, *identical*, *honey-coloured*

**Others**: *reflects*

**Activity (new category)**: *expeditions*, *pursuits*, *engrave*

**Ethnic group (new category)**: *arii*, *ichthyophagi*

Except for showing more specified geographical connections, plants and gemstone names, the descriptive expressions in the list relates to the description of stones, and the special traits of natural creatures originated in India in *Natural History*. The words of the new categories relates to the existing categories. For example, the words of activity relates to the Indian-subcontinent expedition of Alexander the Great, the need for merchandize exchange, and the product processing of gemstones, and the words of ethnic group relates to the geographical introduction about Indian and its connected regions, which reinforced the previous conclusion, that the context of "India" in the work shows focuses on the geographical introduction about India and the trade relation between it and the Roman Empire.

Combining the observation of the three top ranking word lists of textual collocation to word "Inida" in *Natural History*, these collocates suggest the interconnecting role India played in the network of interactions, trade, and cultural exchanges in the narrative.

## Keyword in India-related text in *Natural History*

Additionally, in order to examine the significant phrases, i.e. "keyword", in the India-related content in the work, as a comparison and supplement to the conclusion of textual collocation analysis, a keyword analysis is employed for the India-related text.

The frequency lists for the **target corpus** (India-related texts) and **reference corpus** (whole text) are generated respectively, and the association scores are calculated through the `mclm::assoc_scores()` function. Similar to the collocation analysis, the returned scores are filtered with a criterion of PMI >= 2 and signed $G^2$ >= 3.84, to ensure the selected words for further discussion have a strong attraction to the target corpus with statistical significance [@montes2022].

```{r}
#| label: keyword
#| warning: false

# calculate scores
scores_kw <- assoc_scores(flist_target, flist_ref)

top_scores_kw <- scores_kw %>% 
  filter(PMI >= 2 & G_signed >= 3.84)

```

The following tables present the top 20 keywords in India-related texts as compared to the entire texts in *Natural History*. They are sorted based on their absolute frequencies (@tbl-kwtable_absolute_freqencies), signed $G^2$ scores (@tbl-kwtable_Gsigned) and PMI scores (@tbl-kwtable_PMI) respectively.

::: panel-tabset
### Sorted by absolute frequencies

```{r}
#| label: tbl-kwtable_absolute_freqencies
#| tbl-cap: Top 20 Keywords on Indian Related Text in Natural History (sorted by PMI)

top_scores_kw %>% 
  as_tibble() %>%
  select(type, a, PMI, G_signed) %>% 
  slice_max(order_by = a, n = 20, with_ties = TRUE) %>%                       
  kbl(col.names = c("Type", "Frequency", "PMI", r"(Signed $G^2$)")) %>% 
  kable_minimal() %>% 
  scroll_box(height = "400px")
```

### Sorted by signed $G^2$

```{r}
#| warning: false
#| echo: false
#| label: tbl-kwtable_Gsigned
#| tbl-cap-location: top
#| tbl-cap: Top 20 Keywords on Indian Related Text in Natural History (sorted by signed $G^2$)

top_scores_kw %>% # also valid for top_scores_colloc
  as_tibble() %>%
  select(type, a, PMI, G_signed) %>%         # sort by PMI (descending) 
  slice_max(order_by = G_signed, n = 20, with_ties = TRUE) %>%   
  kbl(col.names = c("Type", "Frequency", "PMI", r"(Signed $G^2$)")) %>% 
  kable_minimal() %>% 
  scroll_box(height = "400px")
```

### Sorted by PMI

```{r}
#| label: tbl-kwtable_PMI
#| tbl-cap: Top 20 Keywords on Indian Related Text in Natural History (sorted by PMI)

top_scores_kw %>% 
  as_tibble() %>%
  select(type, a, PMI, G_signed) %>% 
  slice_max(order_by = PMI, n = 20, with_ties = TRUE) %>%                       
  kbl(col.names = c("Type", "Frequency", "PMI", r"(Signed $G^2$)")) %>% 
  kable_minimal() %>% 
  scroll_box(height = "400px")
```
:::

Among the three lists sorting by different measurements, 16/20 words of absolute frequency top ranking list overlaps with that of the signed $G^2$ scores. As shown in the @fig-col_keyword, the signed $G^2$ score has a positive correlation with the absolute frequency in this case.

```{r}
#| label: fig-col_keyword
#| fig-cap: Scatter plot of signed $G^2$ scores by absolute frequency in keyword analysis

top_scores_kw_df <- as_tibble(top_scores_kw)

theme_set(theme_minimal(base_size = 15))
g <- top_scores_kw_df %>%
  ggplot(aes(x = G_signed, y = a)) +
  labs(x = "signed $G^2$", y = "Absolute frequency") +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) 

g 
```

Combing the top ranking keyword lists sorted by absolute frequency and signed $G^2$ scores, it can be classified into categories similar to that in the previous collocation analysis. In the categorized groups below, those without specifying the association measures ("A" stands for "absolute frequency" and "G" stands for "signed $G^2$ scores") are the overlapped ones.

**Geographical connections**: india, arabia, indian, ganges, indus, ethiopia, taprobane(G), thence, sail(A)

**Animal/Plant**: elephants, pepper(A)

**Precious stone**: stones, amber, rock-crystal, glass, beryls(G)

**Historical figure**: alexander, ichthyophagi(G), megasthenes(G)

**Ethnic group**: indians, tribe(A)

**Descriptive expression (numeric)**: hundred, thousand, fifty(A)

The words in each group partly overlaps with the results in collocation analysis, which on the one hand confirms the potential themes in the India-related content as concluded previously, and on the other hand, suggests that the high evidence ranking textual collocates of "India" also possibly serve as the keywords in the target corpus.

In the comparison of normalized frequency of these words in the target and reference corpra, they all show notably higer frequencies in the target corpus, as shown in @tbl-kw_frequency_compare.

```{r}
#| label: tbl-kw_frequency_compare
#| tbl-cap:  Comparison of overlapping keywords sorted by absolute frequency and G signed with that of reference corpus
flist_ref_df <- as_tibble(flist_ref)
flist_target_df <- as_tibble(flist_target)

words_to_check <- c("india", "hundred", "stones", "arabia", "indian", "alexander",
                    "amber", "thousand", "elephants", "indus", "glass", "thence",
                    "ganges", "rock-crystal", "ethiopia", "indians")


filtered_top_scores <- flist_target_df %>%
  filter(type %in% words_to_check)

tar_nrm_freq_lookup <- setNames(flist_target_df$nrm_freq, flist_target_df$type)

nrm_freq_lookup <- setNames(flist_ref_df$nrm_freq, flist_ref_df$type)

results <- tibble(
  Word = filtered_top_scores$type,
  Target_Nrm_Frequency = tar_nrm_freq_lookup[filtered_top_scores$type],
  Reference_Nrm_Frequency = nrm_freq_lookup[filtered_top_scores$type]
) %>% 
  arrange(desc(Target_Nrm_Frequency)) %>%
  kbl(col.names = c("Type", "Target_Nrm_Frequency", "Reference_Nrm_Frequency")) %>% 
  kable_minimal() %>% 
  scroll_box(height = "400px")


results

```

Furthermore, as PMI score indicates the times of probability of the selected keyword occur in the target corpus higher than that in the reference corpus, it could serve as a more convincing indicator for the analysis of keywords. 

When checking about the normalized frequency of the top 20 keywords with the most PMI score, as shown in @tbl-kw_frequency_pmi, almost all of them are seem distinct in the India-related text, which reinforces the indication that they are especially key to the target corpus comparing to the other parts of the work.

```{r}
#| label: tbl-kw_frequency_pmi
#| tbl-cap:  Comparison of overlapping keywords sorted by absolute frequency and G signed with that of reference corpus

words_to_check_pmi <- c("india", "ganges", "beryls", "indus", "taprobane",
                    "ichthyophagi", "megasthenes", "obsidian", "bdellium",
                    "agates", "callaina", "condensation", "expeditions",
                    "gerra", "jomanes", "nonius", "patala", "prasii", "alia",
                    "bactra", "carnelian", "ceylon", "cophes", "hypasis",
                    "merchandize", "pepper-tree", "sacae", "sandastros",
                    "thorn-bush")

filtered_top_scores_pmi <- top_scores_kw_df %>%
  filter(type %in% words_to_check_pmi)


results1 <- tibble(
  Word = filtered_top_scores_pmi$type,
  Target_Nrm_Frequency = tar_nrm_freq_lookup[filtered_top_scores_pmi$type],
  Reference_Nrm_Frequency = nrm_freq_lookup[filtered_top_scores_pmi$type]
)%>% 
  arrange(desc(Target_Nrm_Frequency)) %>%
  kbl(col.names = c("Type", "Target_Nrm_Frequency", "Reference_Nrm_Frequency")) %>% 
  kable_minimal() %>% 
  scroll_box(height = "400px")


results1


```

For these keywords, a manual examination was performed to determine their meaning and assign classification tags based on their category. The explanations for the top 20 keywords with the highest PMI scores is displayed in @tbl-kwlist below.

```{r}
#| label: tbl-kwlist
#| tbl-cap: Top 20 keywords with meaning sorted by PMI

keyword_PMI_list <- data.frame(
  Word = c("india", "ganges", "beryls", "indus", "taprobane", "ichthyophagi", "megasthenes", "obsidian", "bdellium", "agates", "callaina", "condensation", "expeditions", "gerra", "jomanes", "nonius", "patala", "prasii", "alia", "bactra", "carnelian", "ceylon", "cophes", "hypasis", "merchandize", "peppertree", "sacae", "sandastros", "thornbush"),
  Exp = c("name of the focused region of this study", "a major river in India", "a type of gemstone", "a major river in India", "Island in Sri Lanka", "a group of people who primarily subsist on fish", "a Greek historian and diplomat", "a type of volcanic glass", "a fragrant resin obtained from certain trees", "a type of semiprecious gemstone", "pale green precious stone (lat)", "the process of vapor turning into a liquid state", "referring to the expedition of Alexander the Great", "war (lat)", "name of a river", "a Roman nomen gentile, gens or \"family name\"", "refer to a city in Indian region", "prase, green coloured gem", "by another / different way / route (lat)", "name of a city in Asia Minor", "a reddish-brown variety of chalcedony", "name of an Island in Indian subcontinent", "a river that rises in the ancient Paropamise range, eventually falling into the Indus river near its confluence with the Cophes river", "a river in north India", "goods or commodities", "a tree that produces peppercorns", "the easternmost nation of Elibe, situated to the south of Ilia and the north of Bern", "a precious stone found in India and Arabia", "any of many thorny or spiny shrubs and bushes"),
  Category = c("region", "river", "goods", "river", "region", "people", "people", "goods", "goods", "goods", "goods", "activity", "activity", "activity", "river", "people", "region", "goods", "route", "region", "goods", "region", "river", "river", "goods", "plant", "river", "goods", "plant"),
  Remark = c("N/A", "N/A", "gemstone", "N/A", "N/A", "tribe", "referencing scholar", "other goods", "other goods", "gemstone", "gemstone", "producing activity", "N/A", "N/A", "N/A", "human name", "N/A", "gemstone", "N/A", "N/A", "gemstone", "N/A", "N/A", "N/A", "general goods", "origin of goods", "N/A", "gemstone", "N/A")
)

keyword_PMI_list %>% 
  as_tibble() %>%
  select(Word, Exp, Category, Remark) %>%                        
  kbl(col.names = c("Word", "Exp", "Category", "Remark")) %>% 
  kable_minimal()
```

The distribution plot of categories, as demonstrated in @fig-kwtype, reveals the pattern regarding keywords of India-related texts in *Natural History*.

```{r}
#| warning: false
#| echo: false
#| label: fig-kwtype
#| fig-cap: Top 20 keywords type distribution
#| fig-cap-location: top

tag_counts <- keyword_PMI_list %>%
  count(Category) %>%
  arrange(desc(n))

# Plot the tag distribution
ggplot(tag_counts, aes(x = n, y = reorder(Category, -n), fill = Category)) +
  geom_bar(stat = "identity") +
  labs(x = "Count", y = "Category", fill = "Category") +
  theme_minimal() +
  coord_flip()
```

Significantly, a substantial number of the keywords in the India-related text revolve around goods, particularly precious stones, suggesting a prominent thematic focus. The presence of keywords such as *beryls*, *obsidian*, *bdellium*, *agates*, *callaina*, *prasii*, *carnelian* and *sandastros* indicates the involvement of various gemstones and goods associated with India. These findings are complemented by the presence of keywords like *condensation*, *merchandize* and *pepper tree* which suggest the production and trade of goods between the Roman Empire and the Indian regions during that era.

Furthermore, the keywords related to rivers in India, such as *ganges*, *cophes*, *hypasis*, and *sacae* indicate their significance as sources of goods or as integral parts of trading routes. Since Pliny the Elder's contextual framework includes critical descriptions of the geographical surroundings like rivers, as evident in his references to the Po River and the Nile River [@pollard2009; @murphy2003], a deeper investigation into the portrayal and role of Indian rivers within this context would provide valuable insights.

Additionally, a notable proportion of the keywords pertain to people, encompassing names, descriptions, and specific historical figures like *megasthenes*. This suggests the historical significance of individuals who played a role in trade with India or in documenting and understanding the region.

In conclusion, the keywords extracted from the India-related text in the *Natural History* shed light on India's role in trade, the production of valuable goods, and its association with notable historical figures and geographical features within the perspective of Pliny the Elder during the 1st century AD in the context of the Roman Empire. These findings could also contribute to a better understanding of India's historical interactions with the broader ancient world.

# Conclusion

In conclusion, this paper located the research question on potential theme and topics in texts about India in Pliny the Elder's *Natural History* based on the prominent distribution of "India" in the entire text comparing to other place names. The analysis was conducted with the collocation analysis and keyword analysis in a framework of corpus linguistics.

The analysis of keywords in the India-related text revealed significant themes such as the rivers, gemstones, goods, and historical figures like Megasthenes. These findings emphasize the cultural, geographical, and historical importance of India in the scope of scholars in Roman Empire during 1st century AD.

Moreover, the exploration of collocates uncovered the geographical connections, trading networks, and territorial boundaries linked to India. The collocates highlighted the close relationships with neighboring regions such as Arabia and Ethiopia, along with references to trade, imports, and commodity production.

Additionally, the study provided information on the specific contexts and usage of the word "India" within Pliny the Elder's *Natural History*, as a resource for further analysis about the discourse and recognition of India during that era.

While this research represents an initial exploration, it paves the way for future investigations. Subsequent studies can expand the analysis to encompass a wider range of texts, explore different domains within Indian subcontinent-related literature, and utilize advanced natural language processing techniques to gain deeper semantic insights.
