---
engine: knitr
title: "Collocation and keyword analysis on India-related text of *Natural History*"
author: "Dawn, Lizao Zhuang (r0914937)"
format: 
  html:
    theme: journal
    toc: true
    code-link: true
    abstract-title: "Abstract"
number-sections: true
echo: false
warning: false
tbl-cap-location: top
fig-cap-location: top
bibliography:
  - references.bib
  - packages.bib  
csl: unified-style-sheet-for-linguistics.csl
abstract: 'This paper presents a comprehensive analysis of textual collocations and keywords related to "India" in a corpus of *Natural History*, the earliest known encyclopedia written by Pliny the Elder in the 1st century AD. By analyzing these word associations and significant terms, this study seeks to identify the main themes and topics related to the Indian region within the text. The investigation of how Pliny depicts India in *Natural Hisotry* could potentially contribute to the discussion of the spatial representation and imagination in the work.'
---

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [["$","$"]]}})</script>
<script async src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

```{r setup, include=FALSE}
library('tidyverse')
library('mclm')
library('here')
library('kableExtra')
library('leaflet')
library('downlit')
options(digits = 3)

knitr::write_bib(
  c("base", "mclm", "tidyverse", "leaflet", "kableExtra", "downlit"),
  here("packages.bib")
)
```

# Introduction[^1]

[^1]: The present paper is a pilot study of my master thesis, *Mapping India in Pliny the Elder's Natural History*, thus the description of the research question is connected with the content in this [thesis](https://raw.githack.com/lizaodawn/NH_thesis/main/NHthesis_structure.html#sec-introduction).

Pliny the Elder's *Natural History* is widely recognized as the earliest encyclopedia in the world. Written around AD 77, the work is thematically divided into 37 books, covering a diverse range of subjects including astronomy, geography, zoology, botany, medicine, and more. Driven by a pioneering attempt to catalog all human knowledge from his era, Pliny made a comprehensive reference to a wide range of Greek and Roman scholarships, and interwove his own literary interpretation or comments to the narratives in the work.

*Natural History* stands as a seminal work in the history of encyclopedias, serving as a gateway to understanding the knowledge and worldview of ancient Rome. Beyond its role as a compendium of diverse subjects, the text provides a captivating glimpse into the knowledge, cultural, and merchandize exchange [@dodd2021] between the Roman Empire and other regions [@plinyth2011].

As pointed out by @beagon2011, differentiating from his predecessors, Pliny showed a "terrestrial curiosity" in *Natural History*, emphasizing recognition of the physical, material world. Drawing from the long-established topographical and ethnographic traditions, Pliny connects volumes dedicated to geography (books 3-6) with broader natural elements, human activities, and cultural, historical, and societal contexts [@roller2022], exemplified in his description of plants, tribe habitats, imperial expeditions, and trade products. In this regard, this study aims to analyse the text of *Natural History* in a spatial scope, as geographical names mentioned in the text plays a pivotal role in distributing information, knowledge, and discussions throughout the work.

*Natural History* is originally in Latin. An English translation by Henry T. Riley (1816-1878) and John Bostock (1773-1846), first published in 1855, is utilized for this study. The translated text is obtained in a digitized version from the [TOPOSText project](https://topostext.org/the-project), having been sourced from the Perseus Project and governed by a Creative Commons Attribution-Share-Alike 3.0 U.S. License.

In addition to the digitized textual content of *Natural History*, the place names mentioned in the text are annotated with their corresponding coordinates on TOPOSText. Since the annotations are available in an HTML format, they are scraped and restructured into a dataset of geographical-related text in *Natural History* with [Beautiful Soup](https://www.crummy.com/software/BeautifulSoup/bs4/doc/) library in Python[^2]. The dataset structure, corpus scraping procedure and and corpus extension will be further explained in Corpus Description section (@sec-corpus).

[^2]: The scraping code is uploaded to the same repository of the paper.

As a starting point of this study, @fig-top20geoname reveals the 20 most frequently mentioned geographical names within the text.

```{r}
#| label: fig-top20geoname
#| fig-cap: Top 20 most frequently mentioned place names in *Natural History*


data <- read.csv("geotext_whole.csv")

summary_data <- data %>%
  group_by(ToposText_ID, Place_Name, Lat, Long) %>%
  summarise(Count = n()) %>%
  arrange(desc(Count)) %>%
  ungroup() 


top_20_summary_data <- summary_data %>%
  top_n(20, Count) %>%
  ungroup()

ggplot(top_20_summary_data, aes(x = reorder(Place_Name, -Count), y = Count)) +
  geom_col() +
  labs(x = "Place name", y = "Number of occurrences") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Additionally, @fig-geonamemap depicted the times of each place name found mentioned in the work on a map. The individual places are represented by distinct dots, and its occurring times in the text are represented by the size of the dots. The larger the dot size, the more frequent it is appeared in the context.

```{r}
#| label: fig-geonamemap
#| fig-cap: Mapping of geographical names mentioned in *Natural History*

m <- leaflet() %>%
  addTiles() %>%
  addCircleMarkers(
    data = summary_data,
    lat = ~Lat,
    lng = ~Long,
    radius = sqrt(summary_data$Count) * 0.8,  # Adjust the scaling factor as needed
    color = "blue",
    fill = TRUE,
    fillOpacity = 0.6,
    popup = paste("Place name:", summary_data$Place_Name, "<br>",
                  "Number of occurences:", summary_data$Count)
  )

m

```

An intriguing observation from these figures is that India seems being prominently mentioned in the work despite locating outside the Mediterranean.

Based on this observation, the focus of the study is narrowed down to India-related texts in the *Natural History* to investigate how India is described in the work. By delving into the themes associated with the Indian region using the methods of collocation and keyword analysis, this study aims to examine Pliny the Elder's portrayal of India, which may shed light on the spatial perception and imagination of the representative writers and scholars of ancient Rome.

The following sections provide a detailed explanation of the methodology and corpus used, an interpretation and discussion of the results of the collocation and keyword analysis, and an overall conclusion in response to the research questions.

# Methodology {#sec-method}

To investigate the prominent themes in the India-related content discussed in *Natural History*, the study generally employs methods of collocation analysis and keyword analysis in corpus linguistics, and is conducted in R environment [@R-base]. The discussions are based on the `mclm::assoc_scores` objects returned with [mclm](https://masterclm.github.io/mclm/) [@R-mclm] package. In addition, [tidyverse](https://www.tidyverse.org/) [@R-tidyverse], [leaflet](https://rstudio.github.io/leaflet/) [@R-leaflet] and [kableExtra](http://haozhu233.github.io/kableExtra/) [@R-kableExtra] packages are used for data manipulation and visualization.

In the Data Analysis section (@sec-data_analysis), both of the collocation and keyword analysis are examined using three measures of association, namely absolute frequency, PMI and signed $G^2$ to discuss the potential theme it inferred with an integration of a close reading of the text.

Absolute frequency refers to the simple count of each single type (distinct word) observed in the text. In the case of collocation analysis, it shows how often a type collocates with the target word. While in the case of keyword analysis, it shows how often a type occurs in the target corpus. As a basic counting measure, absolute frequency provide an general view of the word distribution.

PMI (Pointwise Mutual Information) is one of effect size measures for association. It compares the observed co-occurring frequency of two outcomes to the probability of either of them occurring independently. It can be applied to observe word association, and the association between words and context categories as well [@bestvater2022]. As the PMI value increases by one, the probability becomes twice as high. High PMI values indicates strong associations.

$G^2$ refers to the log-likelihood ratio for measuring the strength of statistical evidence of the observasion [@blume2017]. In the context of this study, it indicates how significant the association between the two factors (either for two words or for keywords associating with a target corpus) is. Specificly, the signed $G^2$ score returned by `mclm::assoc_scores` shows the strength of evidence for attraction, i.e. co-occurrence. High signed $G^2$ values suggest that the co-occurrence is unlikely to occur by chance.

Since a PMI score higher than two indicates a four times higher probability of association, and a signed $G^2$ score higher than 3.84 indicates a significant association at a 95% confidence level [@montes2022], a filter of "PMI \>= 2 & signed $G^2$ \>= 3.84" is applied to the returned objects of `mclm::assoc_scores` for both methods to obtain strong and significant association results for further discussion.

## Collocation Analysis

Collocation analysis is a technique used in corpus linguistics to identify words that frequently occur together in a given text. This technique is based on the idea that certain words tend to occur together more often than they would by chance.

This study examines the textual co-occurrence of the word "India" in *Natural History*. Lists of highly frequent words co-occurring with "India" in context are obtained and sorted by scores of different measures. The potential themes of India-related content in the work can be discussed based on the outputs of textual collocation of word "India".

## Keyword Analysis

Keyword analysis is a statistical method used in corpus linguistics to identify words that occur more frequently in a target corpus than in a reference corpus. The words that have a higher association with the target corpus compared to their frequency in the reference corpus are considered to be the "keyword" of the target corpus.

In this study, the **target corpus** includes all paragraphs in *Natural History* that mention place names in Indian regions, and the **reference corpus** includes all other paragraphs in the work. Lists of words with relatively higher frequency in the target corpus are obtained and sorted by the different measurements. The "keywords" found in the India-related text in *Natural History* provide more descriptive information about the topics and elements related to "India" in Pliny's narrative.

By combining the two methods and integrating them with a close reading of the text, this study aims to gain insights into how "India" is discussed and represented in *Natural History*.

# Corpus Description {#sec-corpus}

As mentioned, an English translation by Henry T. Riley (1816-1878) and John Bostock (1773-1846) of the original Latin text of *Natural History* is employed in the study.

The digitized text is available in paragraphs with geographical annotations on TOPOSText website as two parts, [book 1-11](https://topostext.org/work/148) and [book 12-37](https://topostext.org/work/153), both of which are in HTML format. Extracting all "place" classes in the HTML files, information of all annotated place names in the work, the URI and corresponding coordinates of the place, the book/chapter/paragraph number where it is mentioned, as well as the coordinating textual content is structured as a dataset of geographical-related text in *Natural History*. This dataset is used for an initial exploration of the prominent places mentioned in the text.

The initial observation shown in @fig-top20geoname and @fig-geonamemap leads to a focus on the India-related text for this study. With a reference to *Barrington Atlas of the Greek and Roman World* [@talbert2000; @talbert2000-1], the approximate geographical coordinates defining the Indian region during the time of *Natural Hisoty* are as follows[^3]:

[^3]: As indicated in the map-by-map directory, the range spans territories of "modern states of India (minus the Punjab), Bangladesh, Bhutan, Burma, Nepal, and Sri Lanka".

> Latitude: 5-35 degrees North
>
> Longitude: 65-95 degrees East

The records in geographical-related text dataset with corresponding coordinates that fall within the specified range are extracted as the India-related text dataset.

```{r}
#| label: prepare-corpus

# read file names of the corpra
refcorpus_folder <- here("NH_wholetext")
fnames_wholetext <- get_fnames(refcorpus_folder) %>% 
  keep_re("[.]txt")


tarcorpus_folder <-  here("NH_geotext_india")
fnames_indiatext <- get_fnames(tarcorpus_folder) %>% 
  keep_re("[.]txt")

fnames_wholetext_short <- basename(fnames_wholetext)
fnames_indiatext_short <- basename(fnames_indiatext)

# exclude short file names with the same name from target corpus in the reference corpus
fnames_wholetext_short_filtered <- fnames_wholetext_short %>%
  setdiff(fnames_indiatext_short)

# filter full file names based on filtered short names
fnames_wholetext_filtered <- fnames_wholetext[fnames_wholetext_short %in% fnames_wholetext_short_filtered]


# build frequency list for general corpus
flist_gen <- fnames_wholetext %>%
  freqlist(re_token_transf_in = "'", 
           token_transf_out = "")

# build frequency list for reference corpus
flist_ref <- fnames_wholetext_filtered %>%
  freqlist(re_token_transf_in = "'", 
           token_transf_out = "")

# build frequency list for target corpus
flist_target <- fnames_indiatext %>%
  freqlist(re_token_transf_in = "'", 
           token_transf_out = "") 
```

Each distinct paragraph in the India-related text dataset is extracted and stored in TXT format as separate files within a corpus folder, comprising a total of `r length(fnames_indiatext)` files as the **target corpus**. The file names contain information about the book, chapter, and paragraph number of the text. This **target corpus** contains `r prettyNum(n_tokens(flist_target))` tokens and `r n_types(flist_target)` types, with the type-token ratio of `r round(n_types(flist_target)/n_tokens(flist_target), 2)`.

The full text of the entire work, separated in paragraphs, are also scraped and stored in TXT format as a **general corpus**. This **general corpus** of `r length(fnames_wholetext)` files contains `r prettyNum(n_tokens(flist_gen))` tokens and `r n_types(flist_gen)` types, with the type-token ratio of `r round(n_types(flist_gen)/n_tokens(flist_gen), 2)`.

Excluding those in target corpus from the general corpus, the other parts of the work contain `r length(fnames_wholetext_filtered)` files, serve as a **reference corpus**. The **reference corpus** contains `r prettyNum(n_tokens(flist_ref))` tokens and `r n_types(flist_ref)` types, with the type-token ratio of `r round(n_types(flist_ref)/n_tokens(flist_ref), 2)`.

The **general corpus** is employed for the collocation analysis and the **target corpus** and **reference corpus** are used in the keywords analysis.

During the extraction process of the corpus files, the texts are already converted to lower case. In addition, the closing quotation mark "'", which ranks high while provides limited information in the initial observation of the returned frequency lists, is replaced by an empty string for a more informative return for further discussions. 

# Data Analysis {#sec-data_analysis}

## Textual collocating word with "India" in *Natural History*

Collocation analysis traces the frequent occurrence of certain words or phrases in close proximity to each other within a given context. Unlike surface collocation, which considers the collocating span, i.e., the specific words to the left and right of the target word [@evert2009], the span in textual collocation refers to the textual unit around the target word. Setting "India" as the target word for tracing in the corpus of all paragraphs in *Natural History*, the `mclm::text_cooc()` function returns the frequency of words appearing in the context of "India". As mentioned in the Methodology section (@sec-method), the returned results are filtered with a statistical criterion to obtain a list of the most frequently collocated words with the word "India" with strong evidence.

The prominent textual collocates of "India" identified with this approach suggest the potential themes about the Indian region in the narrative of Pliny.

```{r}
#| lable: obtain and filter collocation association scores

coocs <- fnames_wholetext %>% 
  text_cooc("(?xi)  ^ india $")

scores_colloc <- assoc_scores(coocs)

top_scores_colloc <- scores_colloc %>% 
  filter(PMI >= 2 & G_signed >= 3.84)
```

@tbl-coltable_absolute_freqency, @tbl-coltable_Gsigned and @tbl-coltable_PMI show the top 20 textual collocates associated with the word "India", sorted by absolute frequency, signed $G^2$ and PMI scores in decsending order.

::: panel-tabset
### Sorted by absolute frequency

```{r}
#| label: tbl-coltable_absolute_freqency
#| tbl-cap: Top 20 collocates to the word "India" in *Natural History* (sorted by absolute freqency)

top_scores_colloc %>% 
  as_tibble() %>%
  select(type, a, PMI, G_signed) %>% 
  slice_max(order_by = a, n = 20, with_ties = TRUE) %>%
  kbl(col.names = c("Type", "Frequency", "PMI", r"(Signed $G^2$)"), escape = FALSE) %>%
  kable_minimal() %>% 
  scroll_box(height = "400px")

```

### Sorted by Signed $G^2$

```{r}
#| label: tbl-coltable_Gsigned
#| tbl-cap: Top 20 collocates to the word "India" in *Natural History* (sorted by signed $G^2$)

top_scores_colloc %>% 
  as_tibble() %>%
  select(type, a, PMI, G_signed) %>% 
  slice_max(order_by = G_signed, n = 20, with_ties = TRUE) %>%
  kbl(col.names = c("Type", "Frequency", "PMI", r"(Signed $G^2$)"), escape = FALSE) %>%
  kable_minimal() %>% 
  scroll_box(height = "400px")

```

### Sorted by PMI

```{r}
#| label: tbl-coltable_PMI
#| tbl-cap: Top 20 collocates to the word "India" in *Natural History* (sorted by PMI)

top_scores_colloc %>% 
  as_tibble() %>%
  select(type, a, PMI, G_signed) %>%
  slice_max(order_by = PMI, n = 20, with_ties = TRUE) %>% 
  kbl(col.names = c("Type", "Frequency", "PMI", r"(Signed $G^2$)"), escape = FALSE) %>% 
  kable_minimal() %>% 
  scroll_box(height = "400px") 

```
:::

The top 20 ranking word lists of absolute frequency and signed $G^2$ score have a 11/20 overlapping outputs. As shown in @fig-col_colloc, there is a positive correlation between the signed $G^2$ score and absolute frequency in textual collocation analysis.

```{r}
#| label: fig-col_colloc
#| fig-cap: Scatter plot of signed $G^2$ scores by absolute frequency in textual collocation analysis


top_scores_colloc_df <- as_tibble(top_scores_colloc)

theme_set(theme_minimal(base_size = 15))
g1 <- top_scores_colloc_df %>%
  ggplot(aes(x = G_signed, y = a)) +
  labs(x = r"(Signed G)", y = "Absolute frequency") +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) 

g1
```

The high-ranking words collocating with "India", sorted by their absolute frequency and signed $G^2$ score, are categorized as follows. Those without specifying the association measures ("A" stands for "absolute frequency" and "G" stands for "signed $G^2$ score") are the overlapped ones. The overlapped words are considered having the strongest evidence of frequently collocating with "India" in the context.

**Geographical connections**: *arabia*, *indian*, *ethiopia*, *ganges*, *indus*(G)

**Animal/Plant**: *elephants*, *gum*(A), *lustre*(G)

**Precious stone**: *stones*, *rock-crystal*, *gems*, *gem*(G), *gemstone*(G), *pearls*, *smaragdus*(G)

**Historical figure**: *alexander*(A), *megasthenes*(G), *onesicritus*(G)

**Merchandise exchange**: *mart*(G)

**Descriptive expression**: *hundred*, *thousand*(A), *whole*(A), *numerous*(A), *luxury*(A), *closely*(A), *valuable*(A), *bright*(A), *identical*(G)

**Others**: *shadow*(A), *year*(A)

These categories indicate that the "India" narrative in *Natural History* covers three major dimensions. The first dimension is its geographical information, including its connection to other places (primarily Arabia and Ethiopia), the two major rivers in the region, Ganges and Indus, and the animals, plants and precious stones originating from it. And it is frequently mentioned with historical figures, some related to the conquest history of the Roman Empire (in the case of *alexander*, referring to Alexander the Great, who conducted several expeditions to Indian subcontinent), and some related to the referencing scholarship Pliny consulted in the work. Moreover, the term *mart* and the descriptive phrases such as *luxury* and *valuable*, highlights the merchandise exchanges introduced in the discussion of India.

In the `mclm::text_cooc()` function, the given text will be separated as target context (text surrounding the target node) and reference context (text not surrounding the target node). The normalized frequency of the top ranking words with the highest frequency and strongest evidence in the target context are at least 20 times higher than that of the reference context, as shown in @tbl-colloc_freq_compare_AFG.

```{r}
#| label: tbl-colloc_freq_compare_AFG
#| tbl-cap:  Normalized frequency comparison of overlapping top 20 ranking textual "Inida"-collocating words sorted by absolute frequency and signed $G^2$ score in target and reference context

coocs_ref_df <- as_tibble(coocs$ref_freqlist)
coocs_tar_df <- as_tibble(coocs$target_freqlist)

words_to_check_colloc <- c("arabia", "indian", "ethiopia", "ganges", "rock-crystal", "hundred", "elephants", "megasthenes", "indians", "gem", "lustre", "stones", "identical", "'smaragdus", "indus", "gems", "gemstone", "pearls", "onesicritus", "mart")

filtered_top_scores_colloc <- coocs_tar_df %>%
  filter(type %in% words_to_check_colloc)

tar_nrm_freq_lookup1 <- setNames(coocs_tar_df$nrm_freq, coocs_tar_df$type)
nrm_freq_lookup1 <- setNames(coocs_ref_df$nrm_freq, coocs_ref_df$type)

results_colloc <- tibble(
  Word = filtered_top_scores_colloc$type,
  Target_Nrm_Frequency = tar_nrm_freq_lookup1[filtered_top_scores_colloc$type],
  Reference_Nrm_Frequency = nrm_freq_lookup1[filtered_top_scores_colloc$type]
) %>% 
  arrange(desc(Target_Nrm_Frequency)) %>% 
  kbl(col.names = c("Type", "Target_Nrm_Frequency", "Reference_Nrm_Frequency")) %>% 
  kable_minimal() %>% 
  scroll_box(height = "400px")


results_colloc

```

When examining the normalized frequency of the top 20 list sorted by PMI score, as presented in @tbl-colloc_frequency_compare_PMI, all of the results exhibit a higher frequency than that of the reference context as well.

```{r}
#| label: tbl-colloc_frequency_compare_PMI
#| tbl-cap: Normalized frequency comparison of top 20 textual "India"-collocating words sorted by PMI score in target and reference context

words_to_check_colloc_pmi <- c("megasthenes", "thorn-bush", "carnelian", "obsidian", "cophes", "merchandize", "mart", "expeditions", "patala",   "arii", "ichthyophagi", "pursuits", "vermilion", "biggest", "onesicritus", "identical", "ganges", "engrave", "'smaragdus", "honey-coloured",   "reflects"
)

filtered_top_scores_colloc_pmi <- coocs_tar_df %>%
  filter(type %in% words_to_check_colloc_pmi)


results_colloc_pmi <- tibble(
  Word = filtered_top_scores_colloc_pmi$type,
  Target_Nrm_Frequency = tar_nrm_freq_lookup1[filtered_top_scores_colloc_pmi$type],
  Reference_Nrm_Frequency = nrm_freq_lookup1[filtered_top_scores_colloc_pmi$type]
) %>% 
  arrange(desc(Target_Nrm_Frequency)) %>%
  kbl(col.names = c("Type", "Target_Nrm_Frequency", "Reference_Nrm_Frequency")) %>% 
  kable_minimal() %>% 
  scroll_box(height = "400px")

results_colloc_pmi

```

As the PMI sorting identifies the words of the strongest attraction with the word "India" in the context, the listed words provides additional descriptive information about the themes relating to India in the work. Most of them can be classified into the aforementioned categories set for the results of absolute frequency and signed $G^2$ score, some of the words contribute to a new category relating to the existing ones. The top ranking words sorted by PMI are grouped as follows:

**Geographical connections**: *cophes*, *patala*, *ganges*

**Animal/Plant**: *thorn-bush*

**Precious stone**: *carnelian*, *obsidian*, *'smaragdus*

**Historical figure**: *megasthenes*, *onesicritus*

**Merchandise exchange**: *merchandize*, *mart*

**Descriptive expression**: *vermilion*, *biggest*, *identical*, *honey-coloured*

**Others**: *reflects*

**Activity (new category)**: *expeditions*, *pursuits*, *engrave*

**Ethnic group (new category)**: *arii*, *ichthyophagi*

Except for displaying more specific geographic connections, plant and gemstone names, the descriptive expressions in the list pertain to the description of stones (such as *vermilion* and *honey-coloured*) and the special traits of natural creatures originating in India (such as *biggest* and *identical*) in *Natural History*. The words in the new categories relate to the existing categories. For example, the terms in "Activity" refer to Alexander the Great's *expedition* to the Indian subcontinent, the necessity for exchange of merchandise (*pursuits*), and the processing of gemstones (*engrave*). The terms in "Ethnic group" pertain to the human communities living in India and its surrounding regions. This additional information reinforces the conclusion that when "India" is mentioned in the work, Pliny tended to focus his discussion on its geographical conditions and trade relations with the Roman Empire.

The observations from the top ranking "India"-collocating word lists of the three measures highlight how the narrative of *Natural History* underscores India's geographical interconnection and its important role in merchandise and cultural exchange.

## Keywords in India-related text in *Natural History*

Additionally, in order to examine the significant phrases, i.e. "keywords", in the India-related content in the work, a keyword analysis for the India-related text is employed as a comparison and complement to the conclusion of the textual collocation analysis.

The word frequency and their association scores in the **target corpus** (India-related texts) and **reference corpus** (other parts of *Natural History* excluding the India-related texts) are obtained with the `mclm::assoc_scores()` function. Similar to the collocation analysis, the returned scores are filtered with a criterion of PMI \>= 2 and signed $G^2$ \>= 3.84 to ensure that the words selected for further discussion have a strong attraction to the target corpus with statistical significance [@montes2022].

```{r}
#| label: obtain and filter keywords association scores

scores_kw <- assoc_scores(flist_target, flist_ref)

top_scores_kw <- scores_kw %>% 
  filter(PMI >= 2 & G_signed >= 3.84)

```

The following tables show the top 20 keywords in India-related texts as compared to the total texts in *Natural History*. They are sorted by their absolute frequency (@tbl-kwtable_absolute_frequency), signed $G^2$ score (@tbl-kwtable_Gsigned) and PMI score (@tbl-kwtable_PMI) in descending order.

::: panel-tabset
### Sorted by absolute frequency

```{r}
#| label: tbl-kwtable_absolute_frequency
#| tbl-cap: Top 20 keywords of India-related text in *Natural History* (sorted by absolute frequency)

top_scores_kw %>% 
  as_tibble() %>%
  select(type, a, PMI, G_signed) %>% 
  slice_max(order_by = a, n = 20, with_ties = TRUE) %>%                       
  kbl(col.names = c("Type", "Frequency", "PMI", r"(Signed $G^2$)")) %>% 
  kable_minimal() %>% 
  scroll_box(height = "400px")
```

### Sorted by signed $G^2$

```{r}
#| label: tbl-kwtable_Gsigned
#| tbl-cap: Top 20 keywords of India-related text in *Natural History* (sorted by signed $G^2$)

top_scores_kw %>% 
  as_tibble() %>%
  select(type, a, PMI, G_signed) %>%         # sort by PMI (descending) 
  slice_max(order_by = G_signed, n = 20, with_ties = TRUE) %>%   
  kbl(col.names = c("Type", "Frequency", "PMI", r"(Signed $G^2$)")) %>% 
  kable_minimal() %>% 
  scroll_box(height = "400px")
```

### Sorted by PMI

```{r}
#| label: tbl-kwtable_PMI
#| tbl-cap: Top 20 keywords of India-related text in *Natural History* (sorted by PMI)

top_scores_kw %>% 
  as_tibble() %>%
  select(type, a, PMI, G_signed) %>% 
  slice_max(order_by = PMI, n = 20, with_ties = TRUE) %>%                       
  kbl(col.names = c("Type", "Frequency", "PMI", r"(Signed $G^2$)")) %>% 
  kable_minimal() %>% 
  scroll_box(height = "400px")
```
:::

Among the three lists sorted by different measures, 16/20 words of the absolute frequency top ranking list overlap with that of the signed $G^2$ score. As shown in the @fig-col_keyword, the signed $G^2$ score has a positive correlation with the absolute frequency in this case.

```{r}
#| label: fig-col_keyword
#| fig-cap: Scatter plot of signed $G^2$ score by absolute frequency in keyword analysis

top_scores_kw_df <- as_tibble(top_scores_kw)

theme_set(theme_minimal(base_size = 15))
g <- top_scores_kw_df %>%
  ggplot(aes(x = G_signed, y = a)) +
  labs(x = r"(Signed G)", y = "Absolute frequency") +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) 

g 
```

The top 20 keyword lists, sorted by absolute frequency and signed $G^2$ score, can be categorized similarly to the previous collocation analysis. In the categorized groups below, those without association measures remarks ("A" stands for "absolute frequency" and "G" for "signed $G^2$ score") are the overlapping ones.

**Geographical connections**: *india*, *arabia*, *indian*, *ganges*, *indus*, *ethiopia*, *taprobane*(G), *thence*, *sail*(A)

**Animal/Plant**: *elephants*, *pepper*(A)

**Precious stone**: *stones*, *amber*, *rock-crystal*, *glass*, *beryls*(G)

**Historical figure**: *alexander*, *ichthyophagi*(G), *megasthenes*(G)

**Ethnic group**: *indians*, *tribe*(A)

**Descriptive expression (numeric)**: *hundred*, *thousand*, *fifty*(A)

The words in each group partially overlap with the results of the collocation analysis, which on the one hand confirms the potential themes in the India-related content as concluded earlier, and on the other hand suggests that the textual collocates of "India" with a high evidence ranking may also serve as keywords in the target corpus.

Comparing the normalized frequency of these words in the target and reference corpus, they all show significantly higher frequencies in the target corpus, as shown in @tbl-kw_frequency_compare.

```{r}
#| label: tbl-kw_frequency_compare
#| tbl-cap:  Normalized frequency comparison of overlapping top 20 ranking keywords in India-related text sorted by absolute frequency and signed $G^2$ score in target and reference corpus
flist_ref_df <- as_tibble(flist_ref)
flist_target_df <- as_tibble(flist_target)

words_to_check <- c("india", "hundred", "stones", "arabia", "indian", "alexander",
                    "amber", "thousand", "elephants", "indus", "glass", "thence",
                    "ganges", "rock-crystal", "ethiopia", "indians")


filtered_top_scores <- flist_target_df %>%
  filter(type %in% words_to_check)

tar_nrm_freq_lookup <- setNames(flist_target_df$nrm_freq, flist_target_df$type)
nrm_freq_lookup <- setNames(flist_ref_df$nrm_freq, flist_ref_df$type)

results_keyword <- tibble(
  Word = filtered_top_scores$type,
  Target_Nrm_Frequency = tar_nrm_freq_lookup[filtered_top_scores$type],
  Reference_Nrm_Frequency = nrm_freq_lookup[filtered_top_scores$type]
) %>% 
  arrange(desc(Target_Nrm_Frequency)) %>%
  kbl(col.names = c("Type", "Target_Nrm_Frequency", "Reference_Nrm_Frequency")) %>% 
  kable_minimal() %>% 
  scroll_box(height = "400px")


results_keyword

```

Moreover, since the PMI score indicates the degree of probability of the selected keyword's occurrence in the target corpus higher than that in the reference corpus, it could be adopted as a more convincing indicator for keyword analysis.

When checking the normalized frequency of the top 20 keywords with the highest PMI score, as shown in @tbl-kw_frequency_pmi, almost all of them seem to be distinct in the India-related text, which reinforces the indication that they are especially key to the target corpus compared to the other parts of the work.

```{r}
#| label: tbl-kw_frequency_pmi
#| tbl-cap:  Normalized frequency comparison of top 20 ranking keywords in India-related text sorted by PMI in target and reference corpus

words_to_check_pmi <- c("india", "ganges", "beryls", "indus", "taprobane",
                    "ichthyophagi", "megasthenes", "obsidian", "bdellium",
                    "agates", "callaina", "condensation", "expeditions",
                    "gerra", "jomanes", "nonius", "patala", "prasii", "alia",
                    "bactra", "carnelian", "ceylon", "cophes", "hypasis",
                    "merchandize", "pepper-tree", "sacae", "sandastros",
                    "thorn-bush")

filtered_top_scores_pmi <- top_scores_kw_df %>%
  filter(type %in% words_to_check_pmi)


results_keyword_pmi <- tibble(
  Word = filtered_top_scores_pmi$type,
  Target_Nrm_Frequency = tar_nrm_freq_lookup[filtered_top_scores_pmi$type],
  Reference_Nrm_Frequency = nrm_freq_lookup[filtered_top_scores_pmi$type]
)%>% 
  arrange(desc(Target_Nrm_Frequency)) %>%
  kbl(col.names = c("Type", "Target_Nrm_Frequency", "Reference_Nrm_Frequency")) %>% 
  kable_minimal() %>% 
  scroll_box(height = "400px")


results_keyword_pmi


```

These keywords are manually reviewed to determine their meaning and assigned classification tags based on their category. The explanations for the top 20 keywords with the highest PMI scores are displayed in the @tbl-kwlist below.

```{r}
#| label: tbl-kwlist
#| tbl-cap: Explaination and classification of the top 20 keywords in India-related text sorted by PMI

keyword_PMI_list <- data.frame(
  Word = c("india", "indus", "ganges", "beryls", "taprobane", "ichthyophagi", "megasthenes", "obsidian", "bdellium", "agates", "callaina", "condensation", "expeditions", "gerra", "jomanes", "nonius", "patala", "prasii", "alia", "bactra", "carnelian", "ceylon", "cophes", "hypasis", "merchandize", "pepper-tree", "sacae", "sandastros", "thorn-bush"),
  Exp = c("name of the focused region of this study", "a major river in India", "a major river in India", "a type of gemstone", "island in Sri Lanka", "a group of people who primarily subsist on fish", "a Greek historian and diplomat", "a type of volcanic glass", "a fragrant resin obtained from certain trees", "a type of semiprecious gemstone", "pale green precious stone (lat)", "the process of vapor turning into a liquid state", "referring to the expedition of Alexander the Great", "war (lat)", "the most important of the affluents of the Ganges", "a Roman nomen gentile, gens or \"family name\"", "name of an ancient city at the mouth of the Indus River", "prase, green coloured gem", "by another / different way / route (lat)", "name of a city in Asia Minor", "a reddish-brown variety of chalcedony", "name of an island in Indian subcontinent", "a river that emerges in Hindu Kush mountains and empties into the Indus River", "a river in north India", "goods or commodities", "a tree that produces peppercorns", "historic Persian ethnic group", "a precious stone found in India and Arabia", "any of many thorny or spiny shrubs and bushes"),
  Category = c("region", "river", "river", "goods", "region", "people", "people", "goods", "goods", "goods", "goods", "activity", "activity", "activity", "river", "people", "region", "goods", "route", "region", "goods", "region", "river", "river", "goods", "plant", "people", "goods", "plant"),
  Remark = c("N/A", "N/A", "N/A", "gemstone", "N/A", "tribe", "referencing scholar", "other goods", "other goods", "gemstone", "gemstone", "producing activity", "N/A", "N/A", "N/A", "human name", "N/A", "gemstone", "N/A", "N/A", "gemstone", "N/A", "N/A", "N/A", "general goods", "origin of goods", "N/A", "gemstone", "N/A")
)

keyword_PMI_list %>% 
  as_tibble() %>%
  select(Word, Exp, Category, Remark) %>%                        
  kbl(col.names = c("Word", "Explaination", "Category", "Remark")) %>% 
  kable_minimal()
```

@fig-kwtype demonstrates the distribution of the classification tags of the top 20 keywords with the highest PMI score.

```{r}
#| label: fig-kwtype
#| fig-cap: Classification distribution of the top 20 keywords in India-related text sorted by PMI

tag_counts <- keyword_PMI_list %>%
  count(Category) %>%
  arrange(desc(n))

# plot the tag distribution
ggplot(tag_counts, aes(x = n, y = reorder(Category, -n), fill = Category)) +
  geom_bar(stat = "identity") +
  labs(x = "Count", y = "Category", fill = "Category") +
  theme_minimal() +
  coord_flip()
```

A significant proportion of the highest PMI-scored keywords in texts related to India center around the concept of "goods", specifically gemstones. This emphasis on gemstones indicates a prevailing thematic concentration in this context. The inclusion of keywords such as *beryls*, *agates*, *callaina*, *obsidian*, *prasii*, *carnelian*,  *sandastros*, *obsidian* and *bdellium* represents the integration of diverse gemstones and commodities closely linked to India. Complemented by the presence of keywords like *condensation*, *merchandize* and *pepper-tree*, which relate to the production and trade of goods, India's role as an central hub in the Indo-Mediterranean commercial network is emphasized in the narrative.

Additionally, many of the keywords are names of rivers that flow through India, such as *indus*, *ganges*, *jomanes*, *cophes*, and *hypasis*. These rivers are important for transportation within India and connecting it with neighboring regions. Some of them serve as landmarks along trade routes or the origins of traded goods. Taking a broader context into consideration, as noted by @roller2022, Pliny shows a particular interest in rivers in *Natural History*, not only in relation to India. The highlights on rivers reflect a shift in Roman geographical ideology, which accentuates rivers as symbols of territorial expansion and markers of inland regions, as opposed to the Greek tradition that emphasized coastlines.  

Furthermore, a notable proportion of the keywords are place names, encompassing names of cities and islands in Indian subcontinent and its neighboring areas.

To summarize, aside from echoing the prominent themes about India found in the collocation analysis, the keyword analysis reveals two more concrete topics, namely stones and rivers, in the India-related narrative in *Natural History*. These topics provide additional information about the trading products and routes while also reflecting the transition of ancient Rome's geographical ideology from Greek. 

# Conclusion

In conclusion, this paper investigates how Pliny the Elder describes India in his work, *Natural History*, by examining the potential themes and topics related to India. The research question is motivated by the notable frequency of references to "India" throughout the text. The analysis employs methods of collocation and keyword analysis within a corpus linguistics framework.

The exploration of textual collocates to the word "India" reveals the geographical connections, trade networks, historical figures, and scholarly references associated with India in *Natural History*. The collocates also emphasize India's close relationship with neighboring regions such as Arabia and Ethiopia.

Moreover, the examination of keywords in India-related text aligns with the observations from the collocation analysis and highlights potential topics on stones and rivers about India in the work. These findings enhance the interpretation of the identified themes, such as geographical connectivity and merchandise trade, and also reflect Pliny's general geographical concern in the historical context of ancient Rome.

As this paper serves as a preliminary exploration, it encourages further in-depth investigations of the text. A comparative analysis of collocation and keywords centering other neighboring regions to India, and a closer examination of "stone" or "river" in the context, incorporating additional literature regarding the historical and cultural background may offer greater insights and enrich the discussion.